{"description": "Detects SSTI attempts sent via GET requests in access logs", "enabled": false, "false_positives": ["User searches in search boxes of the respective website", "Internal vulnerability scanners can cause some serious FPs when used, if you experience a lot of FPs due to this think of adding more filters such as \"User Agent\" strings and more response codes"], "filters": [], "from": "now-360s", "immutable": false, "index": ["filebeat-*"], "interval": "5m", "rule_id": "ada3bc4f-f0fd-42b9-ba91-e105e8af7342", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Server Side Template Injection Strings", "query": "((http.request.method:\"GET\" AND (*\\=\\{\\{* OR *\\=%7B%7B* OR *\\=$\\{* OR *\\=$%7B* OR *\\=<%\\=* OR *\\=%3C%25\\=* OR *\\=@\\(* OR *freemarker.template.utility.Execute* OR *.getClass\\(\\).forName\\('javax.script.ScriptEngineManager'\\)* OR *T\\(org.apache.commons.io.IOUtils\\)*)) AND (NOT (http.response.status_code:\"404\")))", "meta": {"from": "1m"}, "severity": "high", "tags": [], "to": "now", "type": "query", "threat": [], "version": 1, "references": ["https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection", "https://github.com/payloadbox/ssti-payloads"], "timestamp_override": "event.ingested", "author": ["Nasreddine Bencherchali"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
