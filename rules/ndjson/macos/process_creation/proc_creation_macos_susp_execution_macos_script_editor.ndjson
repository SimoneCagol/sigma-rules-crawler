{"description": "Detects when the macOS Script Editor utility spawns an unusual child process.", "author": ["Tim Rauch (rule)", "Elastic (idea)"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["apm-*-transaction", "auditbeat-*", "endgame-*", "filebeat-*", "packetbeat-*", "winlogbeat-*", "logs-*"], "interval": "5m", "rule_id": "89d3e678-bfa2-3775-d186-54488a02693f", "language": "lucene", "max_signals": 100, "risk_score": 35, "name": "Suspicious Execution via macOS Script Editor", "query": "(process.parent.executable.text:*\\/Script\\ Editor AND ((process.executable.text:(*\\/curl OR *\\/bash OR *\\/sh OR *\\/zsh OR *\\/dash OR *\\/fish OR *\\/osascript OR *\\/mktemp OR *\\/chmod OR *\\/php OR *\\/nohup OR *\\/openssl OR *\\/plutil OR *\\/PlistBuddy OR *\\/xattr OR *\\/sqlite OR *\\/funzip OR *\\/popen)) OR (process.executable.text:(*python* OR *perl*))))", "meta": {"from": "1m"}, "severity": "medium", "tags": ["Defense Evasion", "Initial Access", "T1059", "T1059", "T1204", "T1204", "T1553", "T1566", "T1566"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0001", "reference": "https://attack.mitre.org/tactics/TA0001", "name": "Initial Access"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1566", "name": "Phishing", "reference": "https://attack.mitre.org/techniques/T1566"}, {"id": "T1566", "name": "Phishing", "reference": "https://attack.mitre.org/techniques/T1566"}]}, {"tactic": {"id": "TA0002", "reference": "https://attack.mitre.org/tactics/TA0002", "name": "Execution"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1059", "name": "Command and Scripting Interpreter", "reference": "https://attack.mitre.org/techniques/T1059"}, {"id": "T1059", "name": "Command and Scripting Interpreter", "reference": "https://attack.mitre.org/techniques/T1059"}, {"id": "T1204", "name": "User Execution", "reference": "https://attack.mitre.org/techniques/T1204"}, {"id": "T1204", "name": "User Execution", "reference": "https://attack.mitre.org/techniques/T1204"}]}, {"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1553", "name": "Subvert Trust Controls", "reference": "https://attack.mitre.org/techniques/T1553"}]}], "version": 1, "references": ["https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-7f541fbc4a4a28a92970e8bf53effea5bd934604429112c920affb457f5b2685", "https://wojciechregula.blog/post/macos-red-teaming-initial-access-via-applescript-url/"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
