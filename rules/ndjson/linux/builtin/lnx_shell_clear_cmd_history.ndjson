{"description": "Clear command history in linux which is used for defense evasion.", "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["apm-*-transaction", "auditbeat-*", "endgame-*", "filebeat-*", "packetbeat-*", "winlogbeat-*", "logs-*"], "interval": "5m", "rule_id": "aa4aa339-9033-fc5f-001e-6ac656ea91b5", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Clear Command History", "query": "(*rm\\ *bash_history* OR *echo\\ \\\"\\\"\\ >\\ *bash_history* OR *cat\\ \\/dev\\/null\\ >\\ *bash_history* OR *cat\\ \\/dev\\/zero\\ >\\ *bash_history* OR *ln\\ \\-sf\\ \\/dev\\/null\\ *bash_history* OR *ln\\ \\-sf\\ \\/dev\\/zero\\ *bash_history* OR *truncate\\ \\-s0\\ *bash_history* OR *export\\ HISTFILESIZE\\=0* OR *history\\ \\-c* OR *history\\ \\-w* OR *shred\\ *bash_history* OR *empty_bash_history* OR *chattr\\ \\+i\\ *bash_history*)", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "T1070"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1070", "name": "Indicator Removal on Host", "reference": "https://attack.mitre.org/techniques/T1070"}]}], "version": 1, "references": ["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.003/T1070.003.md", "https://attack.mitre.org/techniques/T1070/003/", "https://www.hackers-arise.com/single-post/2016/06/20/Covering-your-BASH-Shell-Tracks-AntiForensics"], "timestamp_override": "event.ingested", "author": ["Patrick Bareiss"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
