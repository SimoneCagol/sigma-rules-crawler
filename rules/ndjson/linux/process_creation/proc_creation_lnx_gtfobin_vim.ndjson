{"description": "Detects usage of \"vim\" and it's sibilings as a GTFOBin to execute and proxy command and binary execution", "author": ["Nasreddine Bencherchali"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["apm-*-transaction", "auditbeat-*", "endgame-*", "filebeat-*", "packetbeat-*", "winlogbeat-*", "logs-*"], "interval": "5m", "rule_id": "3124bdbb-8252-7d7f-788d-067fd82aa109", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Vim GTFOBin Abuse - Linux", "query": "(process.executable.text:(*\\/vim OR *\\/rvim OR *\\/vimdiff) AND process.command_line.text:(*\\ \\-c\\ * OR *\\ \\-\\-cmd*) AND process.command_line.text:(*\\:\\!\\/* OR *\\:py\\ * OR *\\:lua\\ * OR *\\/bin\\/sh* OR *\\/bin\\/bash* OR *\\/bin\\/dash* OR *\\/bin\\/zsh* OR *\\/bin\\/fish*))", "meta": {"from": "1m"}, "severity": "high", "tags": ["T1083"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0007", "reference": "https://attack.mitre.org/tactics/TA0007", "name": "Discovery"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1083", "name": "File and Directory Discovery", "reference": "https://attack.mitre.org/techniques/T1083"}]}], "version": 1, "references": ["https://gtfobins.github.io/gtfobins/vim/", "https://gtfobins.github.io/gtfobins/rvim/", "https://gtfobins.github.io/gtfobins/vimdiff/"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
