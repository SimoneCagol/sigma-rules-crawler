{"description": "Detects a suspicious curl process start the adds a file to a web request", "enabled": false, "false_positives": ["Scripts created by developers and admins"], "filters": [], "from": "now-360s", "immutable": false, "index": ["apm-*-transaction", "auditbeat-*", "endgame-*", "filebeat-*", "packetbeat-*", "winlogbeat-*", "logs-*"], "interval": "5m", "rule_id": "2be7fe82-b26f-3eac-7c68-76dafe741e88", "language": "lucene", "max_signals": 100, "risk_score": 35, "name": "Suspicious Curl File Upload - Linux", "query": "(process.executable.text:*\\/curl AND process.command_line.text:(*\\ \\-F\\ * OR *\\ \\-\\-form* OR *\\ \\-T\\ * OR *\\ \\-\\-upload\\-file\\ * OR *\\ \\-d\\ * OR *\\ \\-\\-data\\ * OR *\\ \\-\\-data\\-*))", "meta": {"from": "1m"}, "severity": "medium", "tags": ["T1105", "T1567"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0010", "reference": "https://attack.mitre.org/tactics/TA0010", "name": "Exfiltration"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1567", "name": "Exfiltration Over Web Service", "reference": "https://attack.mitre.org/techniques/T1567"}]}], "version": 1, "references": ["https://twitter.com/d1r4c/status/1279042657508081664", "https://medium.com/@petehouston/upload-files-with-curl-93064dcccc76", "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-19---curl-upload-file", "https://curl.se/docs/manpage.html", "https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html"], "timestamp_override": "event.ingested", "author": ["Nasreddine Bencherchali"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
