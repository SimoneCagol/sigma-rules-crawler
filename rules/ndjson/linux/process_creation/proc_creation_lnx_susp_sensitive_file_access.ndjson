{"description": "Detects changes of sensitive and critical files. Monitors files that you don't expect to change without planning on Linux system.", "author": ["@d4ns4n_ (Wuerth-Phoenix)"], "enabled": false, "false_positives": ["Some false positives are to be expected on user or administrator machines. Apply additional filters as needed."], "filters": [], "from": "now-360s", "immutable": false, "index": ["apm-*-transaction", "auditbeat-*", "endgame-*", "filebeat-*", "packetbeat-*", "winlogbeat-*", "logs-*"], "interval": "5m", "rule_id": "86157017-c2b1-4d4a-8c33-93b8e67e4af4", "language": "lucene", "max_signals": 100, "risk_score": 35, "name": "Potential Suspicious Change To Sensitive/Critical Files", "query": "((((process.executable.text:(\"*\\/cat\" OR \"*\\/echo\" OR \"*\\/grep\" OR \"*\\/head\" OR \"*\\/more\" OR \"*\\/tail\") AND process.command_line.text:\"*>*\")) OR (process.executable.text:(\"*\\/emacs\" OR \"*\\/nano\" OR \"*\\/sed\" OR \"*\\/vi\" OR \"*\\/vim\"))) AND process.command_line.text:(\"*\\/bin\\/login*\" OR \"*\\/bin\\/passwd*\" OR \"*\\/boot\\/*\" OR \"*\\/etc\\/\\*.conf*\" OR \"*\\/etc\\/cron.*\" OR \"*\\/etc\\/crontab*\" OR \"*\\/etc\\/hosts*\" OR \"*\\/etc\\/init.d*\" OR \"*\\/etc\\/sudoers*\" OR \"*\\/opt\\/bin\\/*\" OR \"*\\/sbin*\" OR \"*\\/usr\\/bin\\/*\" OR \"*\\/usr\\/local\\/bin\\/*\"))", "meta": {"from": "1m"}, "severity": "medium", "tags": ["T1565"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0034", "reference": "https://attack.mitre.org/tactics/TA0034", "name": "Impact"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1565", "name": "Data Manipulation", "reference": "https://attack.mitre.org/techniques/T1565"}]}], "version": 1, "references": ["https://docs.microsoft.com/en-us/azure/defender-for-cloud/file-integrity-monitoring-overview#which-files-should-i-monitor"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
