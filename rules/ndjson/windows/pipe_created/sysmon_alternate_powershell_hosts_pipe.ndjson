{"description":"Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe Author: Roberto Rodriguez @Cyb3rWard0g, Tim Shelton. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Programs using PowerShell directly without invocation of a dedicated interpreter."],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"f7999728-b776-899b-5cc0-a2490bd8ea04","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":35,"name":"Alternate PowerShell Hosts Pipe","query":"(file.name:\\\\PSHost* AND (NOT ((process.executable:(*\\\\powershell.exe OR *\\\\powershell_ise.exe OR *\\\\WINDOWS\\\\System32\\\\sdiagnhost.exe OR *\\\\WINDOWS\\\\System32\\\\wsmprovhost.exe OR *\\\\Windows\\\\system32\\\\dsac.exe OR *\\\\Windows\\\\system32\\\\wbem\\\\wmiprvse.exe)) OR (NOT _exists_:process.executable) OR (process.executable:*\\:\\\\Program\\ Files* AND process.executable:*\\\\Microsoft\\ SQL\\ Server\\\\* AND process.executable:*\\\\Tools\\\\Binn\\\\SQLPS.exe))))","meta":{"from":"1m"},"severity":"medium","tags":["T1059"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0002","reference":"https://attack.mitre.org/tactics/TA0002","name":"Execution"},"framework":"MITRE ATT&CKÂ®","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
