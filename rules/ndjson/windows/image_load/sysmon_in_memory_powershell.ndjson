{"description":"Detects loading of essential DLL used by PowerShell, but not by the process powershell.exe. Detects meterpreter's \"load powershell\" extension. Author: Tom Kern, oscd.community, Natalia Shornikova, Tim Shelton. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Used by some .NET binaries, minimal on user workstation.","Used by Microsoft SQL Server Management Studio"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"a726c529-2fb9-5301-3941-4430a9ca8940","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":65,"name":"In-memory PowerShell","query":"(file.path:(*\\\\System.Management.Automation.Dll OR *\\\\System.Management.Automation.ni.Dll) AND (NOT (process.executable:(*\\\\powershell.exe OR *\\\\powershell_ise.exe OR *\\\\WINDOWS\\\\System32\\\\sdiagnhost.exe OR *\\\\mscorsvw.exe OR *\\\\WINDOWS\\\\System32\\\\RemoteFXvGPUDisablement.exe OR *\\\\sqlps.exe OR *\\\\wsmprovhost.exe OR *\\\\winrshost.exe OR *\\\\syncappvpublishingserver.exe OR *\\\\runscripthelper.exe OR *\\\\ServerManager.exe OR *\\\\Microsoft\\ SQL\\ Server\\ Management\\ Studio\\ *\\\\Common*\\\\IDE\\\\Ssms.exe OR *\\\\IDE\\\\devenv.exe OR *\\\\ServiceHub.VSDetouredHost.exe OR *\\\\ServiceHub.SettingsHost.exe OR *\\\\ServiceHub.Host.CLR.x86.exe) OR process.executable:(C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\Microsoft\\ Visual\\ Studio\\\\* OR C\\:\\\\Program\\ Files\\\\Microsoft\\ Visual\\ Studio\\\\*))))","meta":{"from":"1m"},"severity":"high","tags":["T1059"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0002","reference":"https://attack.mitre.org/tactics/TA0002","name":"Execution"},"framework":"MITRE ATT&CKÂ®","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
