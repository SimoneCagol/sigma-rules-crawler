{"description": "Detects a non-browser process communicating with the Notion API. This could indicate potential use of a covert C2 channel such as \"OffensiveNotion C2\"", "author": ["Gavin Knapp"], "enabled": false, "false_positives": ["Legitimate applications communicating with the \"api.notion.com\" endpoint that are not already in the exclusion list. The desktop and browser applications do not appear to be using the API by default unless integrations are configured."], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "7e9cf7b6-e827-11ed-a05b-15959c120003", "language": "lucene", "max_signals": 100, "risk_score": 5, "name": "Potentially Suspicious Network Connection To Notion API", "query": "(destination.domain:*api.notion.com* AND (NOT ((process.executable.text:\"*\\\\AppData\\\\Local\\\\Programs\\\\Notion\\\\Notion.exe\") OR (process.executable.text:\"*\\\\brave.exe\") OR (process.executable.text:(\"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\" OR \"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\")) OR (process.executable.text:(\"C:\\Program Files\\Mozilla Firefox\\firefox.exe\" OR \"C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe\")) OR (process.executable.text:(\"C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe\" OR \"C:\\Program Files\\Internet Explorer\\iexplore.exe\")) OR (process.executable.text:\"*\\\\maxthon.exe\") OR (((process.executable.text:\"C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\Microsoft\\\\EdgeWebView\\\\Application\\\\*\") OR (process.executable.text:\"*\\\\WindowsApps\\\\MicrosoftEdge.exe\") OR (process.executable.text:(\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" OR \"C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe\")))) OR ((process.executable.text:(\"C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\Microsoft\\\\EdgeCore\\\\*\" OR \"C\\:\\\\Program\\ Files\\\\Microsoft\\\\EdgeCore\\\\*\") AND process.executable.text:(\"*\\\\msedge.exe\" OR \"*\\\\msedgewebview2.exe\"))) OR (process.executable.text:\"*\\\\opera.exe\") OR (process.executable.text:\"*\\\\safari.exe\") OR (process.executable.text:\"*\\\\seamonkey.exe\") OR (process.executable.text:\"*\\\\vivaldi.exe\") OR (process.executable.text:\"*\\\\whale.exe\"))))", "meta": {"from": "1m"}, "severity": "low", "tags": ["T1102"], "to": "now", "type": "query", "threat": [], "version": 1, "references": ["https://github.com/mttaggart/OffensiveNotion", "https://medium.com/@huskyhacks.mk/we-put-a-c2-in-your-notetaking-app-offensivenotion-3e933bace332"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
