{"description":"Detects process access LSASS memory which is typical for credentials dumping tools Author: Florian Roth, Roberto Rodriguez, Dimitrios Slamaris, Mark Russinovich, Thomas Patzke, Teymur Kheirkhabarov, Sherif Eldeeb, James Dickenson, Aleksey Potapov, oscd.community (update). License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Legitimate software accessing LSASS process for legitimate reason; please add more filters"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"32d0d3e2-e58d-4d41-926b-18b520b2b32d","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":65,"name":"Credentials Dumping Tools Accessing LSASS Memory","query":"((winlog.event_data.TargetImage:*\\\\lsass.exe AND winlog.event_data.GrantedAccess:(0x40* OR 0x100000* OR 0x1410* OR 0x1438* OR 0x143a* OR 0x1418* OR 0x1f0fff* OR 0x1f1fff* OR 0x1f2fff* OR 0x1f3fff*)) AND (NOT ((process.executable:(\"C\\:\\\\WINDOWS\\\\system32\\\\taskmgr.exe\" OR \"C\\:\\\\Windows\\\\System32\\\\perfmon.exe\")) OR (process.executable:C\\:\\\\ProgramData\\\\Microsoft\\\\Windows\\ Defender\\\\* AND process.executable:*\\\\MsMpEng.exe) OR (process.executable:C\\:\\\\Program\\ Files\\\\WindowsApps\\\\* AND process.executable:*\\\\GamingServices.exe AND winlog.event_data.GrantedAccess:(\"0x1410\" OR \"0x410\")) OR (process.executable:(*\\\\PROCEXP64.EXE OR *\\\\PROCEXP.EXE OR *C\\:\\\\WINDOWS\\\\system32\\\\taskhostw.exe) AND winlog.event_data.GrantedAccess:(\"0x1410\" OR \"0x410\")) OR (process.executable:C\\:\\\\ProgramData\\\\VMware\\\\VMware\\ Tools\\\\* AND process.executable:*\\\\vmtoolsd.exe) OR (process.executable:\"C\\:\\\\WINDOWS\\\\system32\\\\svchost.exe\" AND winlog.event_data.GrantedAccess:\"0x100000\") OR (process.executable:(\"C\\:\\\\WINDOWS\\\\system32\\\\wbem\\\\wmiprvse.exe\" OR \"C\\:\\\\Windows\\\\syswow64\\\\MsiExec.exe\" OR \"C\\:\\\\Windows\\\\System32\\\\msiexec.exe\") AND winlog.event_data.GrantedAccess:(\"0x1410\" OR \"0x410\")) OR (process.executable:(*\\\\thor.exe OR *\\\\thor64.exe) AND winlog.event_data.GrantedAccess:(\"0x40\" OR \"0x1010\")) OR (process.executable:*\\\\explorer.exe AND winlog.event_data.GrantedAccess:\"0x401\") OR (process.executable:\"C\\:\\\\Windows\\\\system32\\\\wininit.exe\" AND winlog.event_data.GrantedAccess:\"0x1000000\") OR (process.executable:\"C\\:\\\\Windows\\\\system32\\\\MRT.exe\" AND winlog.event_data.GrantedAccess:(\"0x1410\" OR \"0x1418\")) OR (process.executable:(C\\:\\\\Program\\ Files\\\\* OR C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\*) AND winlog.event_data.GrantedAccess:(\"0x1410\" OR \"0x410\")) OR (process.executable:C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\Microsoft\\\\Edge\\\\Application\\\\* AND process.executable:*\\\\Installer\\\\setup.exe))))","meta":{"from":"1m"},"severity":"high","tags":["Credential Access","T1003"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0006","reference":"https://attack.mitre.org/tactics/TA0006","name":"Credential Access"},"framework":"MITRE ATT&CKÂ®","technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
