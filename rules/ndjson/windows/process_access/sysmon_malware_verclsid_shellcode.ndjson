{"description":"Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro Author: John Lambert (tech), Florian Roth (rule). License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["unknown"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"b7967e22-3d7e-409b-9ed5-cdae3f9243a1","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":65,"name":"Malware Shellcode in Verclsid Target Process","query":"((winlog.event_data.TargetImage:*\\\\verclsid.exe AND winlog.event_data.GrantedAccess:\"0x1FFFFF\") AND ((winlog.event_data.CallTrace:*|UNKNOWN\\(* AND winlog.event_data.CallTrace:*VBE7.DLL*) OR (process.executable:*\\\\Microsoft\\ Office\\\\* AND winlog.event_data.CallTrace:*|UNKNOWN*)))","meta":{"from":"1m"},"severity":"high","tags":["Defense Evasion","Privilege Escalation","T1055"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0004","reference":"https://attack.mitre.org/tactics/TA0004","name":"Privilege Escalation"},"framework":"MITRE ATT&CK®","technique":[{"id":"T1055","name":"Process Injection","reference":"https://attack.mitre.org/techniques/T1055"}]},{"tactic":{"id":"TA0005","reference":"https://attack.mitre.org/tactics/TA0005","name":"Defense Evasion"},"framework":"MITRE ATT&CK®","technique":[{"id":"T1055","name":"Process Injection","reference":"https://attack.mitre.org/techniques/T1055"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
