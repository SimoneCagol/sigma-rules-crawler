{"description":"Detects Obfuscated Powershell via use MSHTA in Scripts Author: Nikita Nazarov, oscd.community. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Unknown"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"31311554-315e-9f25-7583-a9d7bd84732b","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":65,"name":"Invoke-Obfuscation Via Use MSHTA","query":"((powershell.command.invocation_details:*set* OR winlog.event_data.Payload:*set*) AND (powershell.command.invocation_details:*\\&&* OR winlog.event_data.Payload:*\\&&*) AND (powershell.command.invocation_details:*mshta* OR winlog.event_data.Payload:*mshta*) AND (powershell.command.invocation_details:*vbscript\\:createobject* OR winlog.event_data.Payload:*vbscript\\:createobject*) AND (powershell.command.invocation_details:*.run* OR winlog.event_data.Payload:*.run*) AND (powershell.command.invocation_details:*\\(window.close\\)* OR winlog.event_data.Payload:*\\(window.close\\)*))","meta":{"from":"1m"},"severity":"high","tags":["Defense Evasion","T1027","T1059"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0002","reference":"https://attack.mitre.org/tactics/TA0002","name":"Execution"},"framework":"MITRE ATT&CK®","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059"}]},{"tactic":{"id":"TA0005","reference":"https://attack.mitre.org/tactics/TA0005","name":"Defense Evasion"},"framework":"MITRE ATT&CK®","technique":[{"id":"T1027","name":"Obfuscated Files or Information","reference":"https://attack.mitre.org/techniques/T1027"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
