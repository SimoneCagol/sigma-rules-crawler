{"description":"Detects keywords that could indicate clearing PowerShell history Author: Ilyas Ochkov, Jonhnathan Ribeiro, Daniil Yugoslavskiy, oscd.community. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Legitimate PowerShell scripts"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"17f7495e-36b2-d46c-1a87-ecc74f0acf23","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":35,"name":"Clear PowerShell History","query":"(((winlog.event_data.Payload:(*del* OR *Remove\\-Item* OR *rm*) OR powershell.command.invocation_details:(*del* OR *Remove\\-Item* OR *rm*)) AND (winlog.event_data.Payload:*\\(Get\\-PSReadlineOption\\).HistorySavePath* OR powershell.command.invocation_details:*\\(Get\\-PSReadlineOption\\).HistorySavePath*)) OR ((winlog.event_data.Payload:*Set\\-PSReadlineOption* OR powershell.command.invocation_details:*Set\\-PSReadlineOption*) AND (winlog.event_data.Payload:*–HistorySaveStyle* OR powershell.command.invocation_details:*–HistorySaveStyle*) AND (winlog.event_data.Payload:*SaveNothing* OR powershell.command.invocation_details:*SaveNothing*)))","meta":{"from":"1m"},"severity":"medium","tags":["Defense Evasion","T1070"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0005","reference":"https://attack.mitre.org/tactics/TA0005","name":"Defense Evasion"},"framework":"MITRE ATT&CK®","technique":[{"id":"T1070","name":"Indicator Removal on Host","reference":"https://attack.mitre.org/techniques/T1070"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
