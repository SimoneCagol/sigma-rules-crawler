{"description": "Detects when a user disables the Windows Firewall via a Profile to help evade defense.", "author": ["Austin Songer @austinsonger"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "488b44e7-3781-4a71-888d-c95abfacf44d", "language": "lucene", "max_signals": 100, "risk_score": 35, "name": "Windows Firewall Profile Disabled", "query": "(powershell.file.script_block_text:*Set\\-NetFirewallProfile\\ * AND powershell.file.script_block_text:*\\ \\-Enabled\\ * AND powershell.file.script_block_text:*\\ False* AND powershell.file.script_block_text:(*\\ \\-All\\ * OR *Public* OR *Domain* OR *Private*))", "meta": {"from": "1m"}, "severity": "medium", "tags": ["Defense Evasion", "T1562"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1562", "name": "Impair Defenses", "reference": "https://attack.mitre.org/techniques/T1562"}]}], "version": 1, "references": ["https://docs.microsoft.com/en-us/powershell/module/netsecurity/set-netfirewallprofile?view=windowsserver2019-ps", "https://www.tutorialspoint.com/how-to-get-windows-firewall-profile-settings-using-powershell", "http://powershellhelp.space/commands/set-netfirewallrule-psv5.php", "http://woshub.com/manage-windows-firewall-powershell/", "https://www.elastic.co/guide/en/security/current/windows-firewall-disabled-via-powershell.html"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
