{"description":"Detects use of Set-ExecutionPolicy to set a unsecure policies Author: frack113. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Administrator script"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"15d768ca-9dbb-b693-faea-0032eebc569e","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":65,"name":"Change PowerShell Policies to a Unsecure Level","query":"((powershell.file.script_block_text:*Set\\-ExecutionPolicy* AND powershell.file.script_block_text:(*Unrestricted* OR *bypass* OR *RemoteSigned*)) AND (NOT (process.parent.executable:\"C\\:\\\\ProgramData\\\\chocolatey\\\\choco.exe\" OR powershell.file.script_block_text:*\\(New\\-Object\\ System.Net.WebClient\\).DownloadString\\('https\\:\\/\\/community.chocolatey.org\\/install.ps1'\\)*)))","meta":{"from":"1m"},"severity":"high","tags":["T1059"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0002","reference":"https://attack.mitre.org/tactics/TA0002","name":"Execution"},"framework":"MITRE ATT&CKÂ®","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
