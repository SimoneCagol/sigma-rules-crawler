{"description":"A General detection to trigger for processes removing .*\\shell\\open\\command registry keys. Registry keys that might have been used for COM hijacking activities. Author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research). License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["unknown"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"9d18f18d-13c3-6940-0816-99a536784740","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":35,"name":"Removal of Potential COM Hijacking Registry Keys","query":"((winlog.event_data.EventType:\"DeleteKey\" AND winlog.event_data.TargetObject:*\\\\shell\\\\open\\\\command) AND (NOT ((process.executable:\"C\\:\\\\Windows\\\\system32\\\\svchost.exe\") OR (process.executable:(C\\:\\\\Program\\ Files\\\\Common\\ Files\\\\Microsoft\\ Shared\\\\ClickToRun\\\\* OR C\\:\\\\Program\\ Files\\\\Common\\ Files\\\\Microsoft\\ Shared\\\\ClickToRun\\\\Updates\\\\*) AND process.executable:*\\\\OfficeClickToRun.exe) OR (process.executable:\"C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\Microsoft\\ Office\\\\root\\\\integration\\\\integrator.exe\") OR (process.executable:*\\\\Dropbox.exe AND winlog.event_data.TargetObject:HKCR\\\\Dropbox.*))))","meta":{"from":"1m"},"severity":"medium","tags":["Defense Evasion","T1112"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0005","reference":"https://attack.mitre.org/tactics/TA0005","name":"Defense Evasion"},"framework":"MITRE ATT&CKÂ®","technique":[{"id":"T1112","name":"Modify Registry","reference":"https://attack.mitre.org/techniques/T1112"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
