{"description": "Detects the load of drivers used by Process Hacker and System Informer", "author": ["Florian Roth"], "enabled": false, "false_positives": ["Legitimate user of process hacker or system informer by low level developers or system administrators"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "f9d25a8a-7971-0b7a-4d09-6023e54fbe53", "language": "lucene", "max_signals": 100, "risk_score": 35, "name": "Process Hacker and System Informer Driver Load", "query": "((dll.path:(*\\\\kprocesshacker.sys OR *\\\\SystemInformer.sys)) OR (winlog.event_data.Hashes:(*IMPHASH\\=821D74031D3F625BCBD0DF08B70F1E77* OR *IMPHASH\\=F86759BB4DE4320918615DC06E998A39* OR *IMPHASH\\=0A64EEB85419257D0CE32BD5D55C3A18* OR *IMPHASH\\=6E7B34DFC017700B1517B230DF6FF0D0*)) OR (winlog.event_data.Imphash:(\"821D74031D3F625BCBD0DF08B70F1E77\" OR \"F86759BB4DE4320918615DC06E998A39\" OR \"0A64EEB85419257D0CE32BD5D55C3A18\" OR \"6E7B34DFC017700B1517B230DF6FF0D0\")) OR (winlog.event_data.Hashes:(*SHA256\\=8B9AD98944AC9886EA4CB07700E71B78BE4A2740934BB7E46CA3B56A7C59AD24* OR *SHA256\\=A41348BEC147CA4D9EA2869817527EB5CEA2E20202AF599D2B30625433BCF454* OR *SHA256\\=38EE0A88AF8535A11EFE8D8DA9C6812AA07067B75A64D99705A742589BDD846D* OR *SHA256\\=A773891ACF203A7EB0C0D30942FB1347648F1CD918AE2BFD9A4857B4DCF5081B* OR *SHA256\\=4C3B81AC88A987BBDF7D41FA0AECC2CEDF5B9BD2F45E7A21F376D05345FC211D* OR *SHA256\\=3241BC14BEC51CE6A691B9A3562E5C1D52E9D057D27A3D67FD0B245C350B6D34* OR *SHA256\\=047C42E9BBA28366868847C7DAFC1E043FB038C796422D37220493517D68EE89* OR *SHA256\\=18931DC81E95D0020466FA091E16869DBE824E543A4C2C8FE644FA71A0F44FEB* OR *SHA256\\=B4C2EF76C204273132FDE38F0DED641C2C5EE767652E64E4C4071A4A973B6C1B* OR *SHA256\\=640954AFC268565F7DAA6E6F81A8EE05311E33E34332B501A3C3FE5B22ADEA97* OR *SHA256\\=251BE949F662C838718F8AA0A5F8211FB90346D02BD63FF91E6B224E0E01B656* OR *SHA256\\=E2606F272F7BA054DF16BE464FDA57211EF0D14A0D959F9C8DCB0575DF1186E4* OR *SHA256\\=3A9E1D17BEEB514F1B9B3BACAEE7420285DE5CBDCE89C5319A992C6CBD1DE138*)) OR (sha256:(\"8b9ad98944ac9886ea4cb07700e71b78be4a2740934bb7e46ca3b56a7c59ad24\" OR \"a41348bec147ca4d9ea2869817527eb5cea2e20202af599d2b30625433bcf454\" OR \"38ee0a88af8535a11efe8d8da9c6812aa07067b75a64d99705a742589bdd846d\" OR \"a773891acf203a7eb0c0d30942fb1347648f1cd918ae2bfd9a4857b4dcf5081b\" OR \"4c3b81ac88a987bbdf7d41fa0aecc2cedf5b9bd2f45e7a21f376d05345fc211d\" OR \"3241bc14bec51ce6a691b9a3562e5c1d52e9d057d27a3d67fd0b245c350b6d34\" OR \"047c42e9bba28366868847c7dafc1e043fb038c796422d37220493517d68ee89\" OR \"18931dc81e95d0020466fa091e16869dbe824e543a4c2c8fe644fa71a0f44feb\" OR \"b4c2ef76c204273132fde38f0ded641c2c5ee767652e64e4c4071a4a973b6c1b\" OR \"640954afc268565f7daa6e6f81a8ee05311e33e34332b501a3c3fe5b22adea97\" OR \"251be949f662c838718f8aa0a5f8211fb90346d02bd63ff91e6b224e0e01b656\" OR \"e2606f272f7ba054df16be464fda57211ef0d14a0d959f9c8dcb0575df1186e4\" OR \"3a9e1d17beeb514f1b9b3bacaee7420285de5cbdce89c5319a992c6cbd1de138\")))", "meta": {"from": "1m"}, "severity": "medium", "tags": ["Privilege Escalation", "T1543"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0004", "reference": "https://attack.mitre.org/tactics/TA0004", "name": "Privilege Escalation"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1543", "name": "Create or Modify System Process", "reference": "https://attack.mitre.org/techniques/T1543"}]}], "version": 1, "references": ["https://processhacker.sourceforge.io/", "https://systeminformer.sourceforge.io/", "https://github.com/winsiderss/systeminformer"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
