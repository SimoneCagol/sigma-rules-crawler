{"description":"Detects a specific process creation patterns as seen used by UNC2452 and provided by Microsoft as Microsoft Defender ATP queries Author: Florian Roth. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Unknown"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"6504350a-67c7-8e72-aea9-5be509a2b2a0","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":95,"name":"UNC2452 Process Creation Patterns","query":"((((process.command_line:*7z.exe\\ a\\ \\-v500m\\ \\-mx9\\ \\-r0\\ \\-p* OR (process.parent.command_line:*wscript.exe* AND process.parent.command_line:*.vbs* AND process.command_line:*rundll32.exe* AND process.command_line:*C\\:\\\\Windows* AND process.command_line:*.dll,Tk_*)) OR (process.parent.executable:*\\\\rundll32.exe AND process.parent.command_line:*C\\:\\\\Windows* AND process.command_line:*cmd.exe\\ \\/C\\ *)) OR (process.command_line:*rundll32\\ c\\:\\\\windows\\\\* AND process.command_line:*.dll\\ *)) OR ((process.parent.executable:*\\\\rundll32.exe AND process.executable:*\\\\dllhost.exe) AND (NOT (process.command_line:(\"\\ \" OR \"\")))))","meta":{"from":"1m"},"severity":"critical","tags":["T1059"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0002","reference":"https://attack.mitre.org/tactics/TA0002","name":"Execution"},"framework":"MITRE ATT&CKÂ®","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
