{"description":"Detects the creation of a schtask that executes a base64 encoded payload stored in the Windows Registry using PowerShell. Author: @Kostastsale, @TheDFIRReport, slightly modified by pH-T. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Unknown"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"c4eeeeae-89f4-43a7-8b48-8d1bdfa66c78","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":65,"name":"Scheduled Task Executing Powershell Encoded Payload from Registry","query":"(process.executable:*\\\\schtasks.exe AND process.command_line:*\\/Create* AND process.command_line:*\\/SC* AND process.command_line:*FromBase64String* AND process.command_line:*Get\\-ItemProperty* AND process.command_line:(*HKCU\\:* OR *HKLM\\:* OR *registry\\:\\:* OR *HKEY_*))","meta":{"from":"1m"},"severity":"high","tags":["T1053","T1059"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0002","reference":"https://attack.mitre.org/tactics/TA0002","name":"Execution"},"framework":"MITRE ATT&CK®","technique":[{"id":"T1053","name":"Scheduled Task/Job","reference":"https://attack.mitre.org/techniques/T1053"},{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059"}]},{"tactic":{"id":"TA0003","reference":"https://attack.mitre.org/tactics/TA0003","name":"Persistence"},"framework":"MITRE ATT&CK®","technique":[{"id":"T1053","name":"Scheduled Task/Job","reference":"https://attack.mitre.org/techniques/T1053"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
