{"description":"Detects suspicious ways to run Invoke-Execution using IEX acronym Author: Florian Roth. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Legitimate scripts that use IEX"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"616bee90-34be-cc4c-5051-f5d13436098a","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":65,"name":"Suspicious PowerShell IEX Execution Patterns","query":"((process.executable:*\\\\powershell.exe AND process.command_line:*\\-'\\ |\\ iex;'\\ \\-'\\ |\\ iex\\ '\\ \\-'\\ |\\ iex\\}'\\ \\-'\\ |\\ IEX;'\\ \\-'\\ |\\ IEX\\ ;'\\ \\-'\\ |\\ IEX\\ \\-Error'\\ \\-'\\ |\\ IEX\\ \\(new'\\ \\-'\\ |\\ IEX\\ \\(New'\\ \\-'\\);IEX\\ '* AND process.command_line:(*\\:\\:FromBase64String* OR *.GetString\\(\\[System.Convert\\]\\:\\:*)) OR process.command_line:*\\-'\\)|iex;$'\\ \\-'\\)|IEX;$'\\ \\-'\\);iex\\($'\\ \\-'\\);iex\\ $'\\ \\-'\\ |\\ IEX\\ |\\ '*)","meta":{"from":"1m"},"severity":"high","tags":[],"to":"now","type":"query","threat":[],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
