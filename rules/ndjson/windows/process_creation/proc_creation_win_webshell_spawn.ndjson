{"description": "Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack", "enabled": false, "false_positives": ["Particular web applications may spawn a shell process legitimately"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "5dfb3a75-d9ae-bf23-42db-c5a4e149b4c8", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Shells Spawned by Web Servers", "query": "(((process.parent.executable.text:(*\\\\w3wp.exe OR *\\\\php\\-cgi.exe OR *\\\\nginx.exe OR *\\\\httpd.exe OR *\\\\caddy.exe OR *\\\\ws_TomcatService.exe OR *\\\\tomcat.exe OR *\\\\UMWorkerProcess.exe) OR (process.parent.executable.text:(*\\\\java.exe OR *\\\\javaw.exe) AND process.parent.executable.text:(*\\-tomcat\\-* OR *\\\\tomcat*)) OR (process.parent.executable.text:(*\\\\java.exe OR *\\\\javaw.exe) AND process.parent.command_line.text:(*catalina.jar* OR *CATALINA_HOME* OR *catalina.home*))) AND process.executable.text:(*\\\\cmd.exe OR *\\\\sh.exe OR *\\\\bash.exe OR *\\\\powershell.exe OR *\\\\pwsh.exe OR *\\\\bitsadmin.exe)) AND (NOT ((process.command_line.text:*Windows\\\\system32\\\\cmd.exe\\ \\/c\\ C\\:\\\\ManageEngine\\\\ADManager\\ \\\"Plus\\\\ES\\\\bin\\\\elasticsearch.bat\\ \\-Enode.name\\=RMP\\-NODE1\\ \\-pelasticsearch\\-pid.txt))))", "meta": {"from": "1m"}, "severity": "high", "tags": ["T1190", "T1505"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0003", "reference": "https://attack.mitre.org/tactics/TA0003", "name": "Persistence"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1505", "name": "Server Software Component", "reference": "https://attack.mitre.org/techniques/T1505"}]}], "version": 1, "references": ["https://tdm.socprime.com/tdm/info/0"], "timestamp_override": "event.ingested", "author": ["Thomas Patzke", "Florian Roth", "Zach Stanford @svch0st", "Tim Shelton"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
