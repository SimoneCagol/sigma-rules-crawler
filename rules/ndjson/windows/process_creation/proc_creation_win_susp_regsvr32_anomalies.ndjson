{"description": "Detects various anomalies in relation to regsvr32.exe", "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "23dc8f9c-7bb6-d844-f632-e6c3a4095e02", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Regsvr32 Anomaly", "query": "(((process.executable.text:*\\\\regsvr32.exe AND process.command_line.text:*\\\\Temp\\\\*) OR (process.executable.text:*\\\\regsvr32.exe AND process.parent.executable.text:(*\\\\powershell.exe OR *\\\\pwsh.exe OR *\\\\powershell_ise.exe)) OR (process.executable.text:*\\\\regsvr32.exe AND process.parent.executable.text:*\\\\cmd.exe) OR (process.executable.text:*\\\\regsvr32.exe AND process.command_line.text:*\\/i\\:* AND process.command_line.text:*http* AND process.command_line.text:*scrobj.dll) OR (process.executable.text:*\\\\regsvr32.exe AND process.command_line.text:*\\/i\\:* AND process.command_line.text:*ftp* AND process.command_line.text:*scrobj.dll) OR (process.executable.text:*\\\\wscript.exe AND process.parent.executable.text:*\\\\regsvr32.exe) OR (process.executable.text:*\\\\EXCEL.EXE AND process.command_line.text:*..\\\\..\\\\..\\\\Windows\\\\System32\\\\regsvr32.exe\\ *) OR (process.parent.executable.text:*\\\\mshta.exe AND process.executable.text:*\\\\regsvr32.exe) OR (process.executable.text:*\\\\regsvr32.exe AND process.command_line.text:(*\\\\AppData\\\\Local* OR *C\\:\\\\Users\\\\Public*)) OR (process.executable.text:*\\\\regsvr32.exe AND process.command_line.text:(*.jpg OR *.jpeg OR *.png OR *.gif OR *.bin OR *.tmp OR *.temp OR *.txt))) AND (NOT ((process.command_line.text:(*\\\\AppData\\\\Local\\\\Microsoft\\\\Teams* OR *\\\\AppData\\\\Local\\\\WebEx\\\\WebEx64\\\\Meetings\\\\atucfobj.dll*)) OR (process.parent.executable.text:\"C\\:\\\\Program\\ Files\\\\Box\\\\Box\\\\FS\\\\streem.exe\" AND process.command_line.text:*\\\\Program\\ Files\\\\Box\\\\Box\\\\Temp\\\\*) OR (process.command_line.text:*\\/s\\ C\\:\\\\Windows\\\\System32\\\\RpcProxy\\\\RpcProxy.dll))))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "T1218"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1218", "name": "System Binary Proxy Execution", "reference": "https://attack.mitre.org/techniques/T1218"}]}], "version": 1, "references": ["https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html", "https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/"], "timestamp_override": "event.ingested", "author": ["Florian Roth", "oscd.community", "Tim Shelton"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
