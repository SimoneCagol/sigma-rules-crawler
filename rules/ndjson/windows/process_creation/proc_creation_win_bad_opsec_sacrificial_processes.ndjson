{"description": "Detects attackers using tooling with bad opsec defaults e.g. spawning a sacrificial process to inject a capability into the process without taking into account how the process is normally run, one trivial example of this is using rundll32.exe without arguments as a sacrificial process (default in CS, now highlighted by c2lint), running WerFault without arguments (Kraken - credit am0nsec), and other examples.", "enabled": false, "false_positives": ["Unlikely"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "e64bad00-8ae1-1b20-692a-d510d739ed1f", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Bad Opsec Defaults Sacrificial Processes With Improper Arguments", "query": "((process.executable.text:*\\\\WerFault.exe AND process.command_line.text:*WerFault.exe) OR (process.executable.text:*\\\\rundll32.exe AND process.command_line.text:*rundll32.exe) OR (process.executable.text:*\\\\regsvcs.exe AND process.command_line.text:*regsvcs.exe) OR (process.executable.text:*\\\\regasm.exe AND process.command_line.text:*regasm.exe) OR (process.executable.text:*\\\\regsvr32.exe AND process.command_line.text:*regsvr32.exe))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "T1218"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1218", "name": "System Binary Proxy Execution", "reference": "https://attack.mitre.org/techniques/T1218"}]}], "version": 1, "references": ["https://blog.malwarebytes.com/malwarebytes-news/2020/10/kraken-attack-abuses-wer-service/", "https://www.cobaltstrike.com/help-opsec", "https://twitter.com/CyberRaiju/status/1251492025678983169", "https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regsvr32", "https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/rundll32", "https://docs.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool", "https://docs.microsoft.com/en-us/dotnet/framework/tools/regsvcs-exe-net-services-installation-tool#feedback"], "timestamp_override": "event.ingested", "author": ["Oleg Kolesnikov @securonix invrep_de", "oscd.community", "Florian Roth", "Christian Burkard"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
