{"description": "Detects suspicious child processes of electron apps (teams, discord, slack, etc.). This could be a potential sign of \".asar\" file tampering (See reference section for more information) or binary execution proxy through specific CLI arguments (see related rule)\n", "author": ["Nasreddine Bencherchali (Nextron Systems)"], "enabled": false, "false_positives": ["Legitimate child processes can occur in cases of debugging"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "f26eb764-fd89-464b-85e2-dc4a8e6e77b8", "language": "lucene", "max_signals": 100, "risk_score": 35, "name": "Suspicious Electron Application Child Processes", "query": "(event.category:process AND ((process.parent.executable:(/.*\\\\[Cc][Hh][Rr][Oo][Mm][Ee]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Dd][Ii][Ss][Cc][Oo][Rr][Dd]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Gg][Ii][Tt][Hh][Uu][Bb][Dd][Ee][Ss][Kk][Tt][Oo][Pp]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Kk][Ee][Yy][Bb][Aa][Ss][Ee]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Mm][Ss][Ee][Dd][Gg][Ee]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Mm][Ss][Ee][Dd][Gg][Ee][Ww][Ee][Bb][Vv][Ii][Ee][Ww]2\\.[Ee][Xx][Ee]/ OR /.*\\\\[Mm][Ss][Tt][Ee][Aa][Mm][Ss]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Ss][Ll][Aa][Cc][Kk]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Tt][Ee][Aa][Mm][Ss]\\.[Ee][Xx][Ee]/) AND ((process.executable:(/.*\\\\[Cc][Mm][Dd]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Cc][Ss][Cc][Rr][Ii][Pp][Tt]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Mm][Ss][Hh][Tt][Aa]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Pp][Oo][Ww][Ee][Rr][Ss][Hh][Ee][Ll][Ll]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Pp][Ww][Ss][Hh]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Rr][Ee][Gg][Ss][Vv][Rr]32\\.[Ee][Xx][Ee]/ OR /.*\\\\[Ww][Ss][Cc][Rr][Ii][Pp][Tt]\\.[Ee][Xx][Ee]/)) OR (process.executable:(/.*\\\\[Aa][Pp][Pp][Dd][Aa][Tt][Aa]\\\\[Ll][Oo][Cc][Aa][Ll]\\\\[Tt][Ee][Mm][Pp]\\\\.*/ OR /.*\\\\[Uu][Ss][Ee][Rr][Ss]\\\\[Pp][Uu][Bb][Ll][Ii][Cc]\\\\.*/ OR /.*\\\\[Ww][Ii][Nn][Dd][Oo][Ww][Ss]\\\\[Tt][Ee][Mm][Pp]\\\\.*/ OR /.*\\:\\\\[Tt][Ee][Mm][Pp]\\\\.*/)))) AND (NOT (((process.parent.executable:/.*\\\\[Cc][Hh][Rr][Oo][Mm][Ee]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Cc][Hh][Rr][Oo][Mm][Ee]\\.[Ee][Xx][Ee]/)) OR ((process.parent.executable:/.*\\\\[Dd][Ii][Ss][Cc][Oo][Rr][Dd]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Dd][Ii][Ss][Cc][Oo][Rr][Dd]\\.[Ee][Xx][Ee]/)) OR ((process.parent.executable:/.*\\\\[Gg][Ii][Tt][Hh][Uu][Bb][Dd][Ee][Ss][Kk][Tt][Oo][Pp]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Gg][Ii][Tt][Hh][Uu][Bb][Dd][Ee][Ss][Kk][Tt][Oo][Pp]\\.[Ee][Xx][Ee]/)) OR ((process.parent.executable:/.*\\\\[Kk][Ee][Yy][Bb][Aa][Ss][Ee]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Kk][Ee][Yy][Bb][Aa][Ss][Ee]\\.[Ee][Xx][Ee]/)) OR ((process.parent.executable:/.*\\\\[Mm][Ss][Ee][Dd][Gg][Ee]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Mm][Ss][Ee][Dd][Gg][Ee]\\.[Ee][Xx][Ee]/)) OR ((process.parent.executable:/.*\\\\[Mm][Ss][Ee][Dd][Gg][Ee][Ww][Ee][Bb][Vv][Ii][Ee][Ww]2\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Mm][Ss][Ee][Dd][Gg][Ee][Ww][Ee][Bb][Vv][Ii][Ee][Ww]2\\.[Ee][Xx][Ee]/)) OR ((process.parent.executable:/.*\\\\[Mm][Ss][Tt][Ee][Aa][Mm][Ss]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Mm][Ss][Tt][Ee][Aa][Mm][Ss]\\.[Ee][Xx][Ee]/)) OR ((process.parent.executable:/.*\\\\[Ss][Ll][Aa][Cc][Kk]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Ss][Ll][Aa][Cc][Kk]\\.[Ee][Xx][Ee]/)) OR ((process.parent.executable:/.*\\\\[Tt][Ee][Aa][Mm][Ss]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Tt][Ee][Aa][Mm][Ss]\\.[Ee][Xx][Ee]/)) OR (process.executable:(/[Cc]\\:\\\\[Ww][Ii][Nn][Dd][Oo][Ww][Ss]\\\\[Ss][Yy][Ss][Ww][Oo][Ww]64\\\\[Ww][Ee][Rr][Ff][Aa][Uu][Ll][Tt]\\.[Ee][Xx][Ee]/ OR /[Cc]\\:\\\\[Ww][Ii][Nn][Dd][Oo][Ww][Ss]\\\\[Ss][Yy][Ss][Tt][Ee][Mm]32\\\\[Ww][Ee][Rr][Ff][Aa][Uu][Ll][Tt]\\.[Ee][Xx][Ee]/))))) AND (NOT (process.parent.executable:/.*\\\\[Dd][Ii][Ss][Cc][Oo][Rr][Dd]\\.[Ee][Xx][Ee]/ AND process.command_line:/.*\\\\[Nn][Vv][Ss][Mm][Ii]\\\\[Nn][Vv][Ii][Dd][Ii][Aa]\\-[Ss][Mm][Ii]\\.[Ee][Xx][Ee].*/)))", "meta": {"from": "1m"}, "severity": "medium", "tags": [], "to": "now", "type": "query", "threat": [], "version": 1, "references": ["https://taggart-tech.com/quasar-electron/", "https://github.com/mttaggart/quasar", "https://positive.security/blog/ms-officecmd-rce", "https://lolbas-project.github.io/lolbas/Binaries/Msedge/", "https://lolbas-project.github.io/lolbas/Binaries/Teams/", "https://lolbas-project.github.io/lolbas/Binaries/msedgewebview2/", "https://medium.com/@MalFuzzer/one-electron-to-rule-them-all-dc2e9b263daf"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
