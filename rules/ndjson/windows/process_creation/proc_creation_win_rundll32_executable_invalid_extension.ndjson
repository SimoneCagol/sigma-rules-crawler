{"description": "Detects the execution of rundll32 with a command line that doesn't contain a .dll file", "author": ["Tim Shelton", "Florian Roth (Nextron Systems)", "Yassine Oukessou (fix + fp)"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "c3a99af4-35a9-4668-879e-c09aeb4f2bdf", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Rundll32 Execution Without DLL File", "query": "(((process.executable.text:\"*\\\\rundll32.exe\") OR (winlog.event_data.OriginalFileName:\"RUNDLL32.EXE\")) AND (NOT ((NOT _exists_:process.command_line.text) OR (((process.command_line.text:\"*.dll*\") OR (process.command_line.text:\"\"))) OR (process.command_line.text:\"C\\:\\\\Windows\\\\system32\\\\rundll32.exe\\ C\\:\\\\Windows\\\\system32\\\\inetcpl.cpl,ClearMyTracksByProcess*\") OR ((process.parent.executable.text:\"*\\:\\\\Program\\ Files\\\\Internet\\ Explorer\\\\iexplore.exe\" AND process.command_line.text:\"*.cpl*\")) OR ((process.parent.executable.text:\"*\\:\\\\Windows\\\\SysWOW64\\\\msiexec.exe\" AND process.parent.command_line.text:\"C\\:\\\\Windows\\\\syswow64\\\\MsiExec.exe\\ \\-Embedding*\")) OR ((process.parent.executable.text:\"*\\:\\\\Windows\\\\System32\\\\msiexec.exe\" AND process.parent.command_line.text:\"C\\:\\\\Windows\\\\system32\\\\MsiExec.exe\\ \\-Embedding*\")) OR ((process.parent.executable.text:\"*\\:\\\\Windows\\\\System32\\\\cmd.exe\" AND process.parent.command_line.text:\"*\\ C\\:\\\\Program\\ Files\\\\SplunkUniversalForwarder\\\\*\")) OR (process.command_line.text:\"*\\ \\-localserver\\ *\") OR (((process.parent.command_line.text:\"C\\:\\\\Windows\\\\system32\\\\rundll32.exe\\\"\\ \\\"C\\:\\\\Program\\ Files\\\\McAfee\\\\MSC\\\\mcmscins.dll\\\",DllUninstallFunction\\ *\") OR (process.command_line.text:\"C\\:\\\\Windows\\\\system32\\\\rundll32.exe\\\"\\ \\/uninstall\\ \\/longpath\\ \\\"C\\:\\\\Program\\ Files\\\\McAfee\\\\MSC\\\\mscrem.inf*\"))) OR ((process.parent.executable.text:\"C\\:\\\\Users\\\\*\" AND process.parent.executable.text:\"*\\\\AppData\\\\Local\\\\Microsoft\\\\EdgeUpdate\\\\Install\\\\\\{*\" AND process.parent.executable.text:\"*\\\\setup.exe\" AND process.parent.command_line.text:\"*\\\\setup.exe\\\"\\ \\-\\-install\\-archive\\=\\\"C\\:\\\\Users\\\\*\")) OR (process.command_line.text:\"*C\\:\\\\Windows\\\\Installer\\\\MSI*\" AND process.command_line.text:\"*.tmp*\" AND process.command_line.text:\"*zzzzInvokeManagedCustomActionOutOfProc*\" AND process.command_line.text:\"*Avira.OE.Setup*\"))))", "meta": {"from": "1m"}, "severity": "high", "tags": [], "to": "now", "type": "query", "threat": [], "version": 1, "references": ["https://twitter.com/mrd0x/status/1481630810495139841?s=12"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
