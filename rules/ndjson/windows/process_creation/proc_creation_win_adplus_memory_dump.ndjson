{"description": "Detects execution of \"AdPlus.exe\", a binary that is part of the Windows SDK that can be used as a LOLBIN in order to dump process memory and execute arbitrary commands.", "author": ["Nasreddine Bencherchali (Nextron Systems)"], "enabled": false, "false_positives": ["Legitimate usage of Adplus for debugging purposes"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "2f869d59-7f6a-4931-992c-cce556ff2d53", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Potential Adplus.EXE Abuse", "query": "(((process.executable:/.*\\\\\\\\[Aa][Dd][Pp][Ll][Uu][Ss]\\.[Ee][Xx][Ee]/) OR (winlog.event_data.OriginalFileName:/[Aa][Dd][Pp][Ll][Uu][Ss]\\.[Ee][Xx][Ee]/)) AND process.command_line:(/.*\\ \\-[Hh][Aa][Nn][Gg]\\ .*/ OR /.*\\ \\-[Pp][Nn]\\ .*/ OR /.*\\ \\-[Pp][Mm][Nn]\\ .*/ OR /.*\\ \\-[Pp]\\ .*/ OR /.*\\ \\-[Pp][Oo]\\ .*/ OR /.*\\ \\-[Cc]\\ .*/ OR /.*\\ \\-[Ss][Cc]\\ .*/))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "T1003"], "to": "now", "type": "query", "threat": [], "version": 1, "references": ["https://lolbas-project.github.io/lolbas/OtherMSBinaries/Adplus/", "https://twitter.com/nas_bench/status/1534916659676422152", "https://twitter.com/nas_bench/status/1534915321856917506"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
