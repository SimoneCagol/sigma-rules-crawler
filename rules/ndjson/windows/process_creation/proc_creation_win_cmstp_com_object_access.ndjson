{"description": "Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65)", "enabled": false, "false_positives": ["Legitimate CMSTP use (unlikely in modern enterprise environments)"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "4b60e6f2-bf39-47b4-b4ea-398e33cfe253", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "CMSTP UAC Bypass via COM Object Access", "query": "(process.parent.executable:*\\\\DllHost.exe AND IntegrityLevel:(\"High\" OR \"System\") AND process.parent.command_line:(*\\ \\/Processid\\:\\{3E5FC7F9\\-9A51\\-4367\\-9063\\-A120244FBEC7\\}* OR *\\ \\/Processid\\:\\{3E000D72\\-A845\\-4CD9\\-BD83\\-80C07C3B881F\\}* OR *\\ \\/Processid\\:\\{BD54C901\\-076B\\-434E\\-B6C7\\-17C531F4AB41\\}* OR *\\ \\/Processid\\:\\{D2E7041B\\-2927\\-42FB\\-8E9F\\-7CE93B6DC937\\}* OR *\\ \\/Processid\\:\\{E9495B87\\-D950\\-4AB5\\-87A5\\-FF6D70BF3E90\\}*))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "Privilege Escalation", "T1218", "T1548"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0004", "reference": "https://attack.mitre.org/tactics/TA0004", "name": "Privilege Escalation"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1548", "name": "Abuse Elevation Control Mechanism", "reference": "https://attack.mitre.org/techniques/T1548"}]}, {"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1218", "name": "Signed Binary Proxy Execution", "reference": "https://attack.mitre.org/techniques/T1218"}, {"id": "T1548", "name": "Abuse Elevation Control Mechanism", "reference": "https://attack.mitre.org/techniques/T1548"}]}], "version": 1, "references": ["https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/", "https://twitter.com/hFireF0X/status/897640081053364225", "https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf", "https://github.com/hfiref0x/UACME"], "timestamp_override": "event.ingested", "author": ["Nik Seetharaman", "Christian Burkard"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
