{"description": "Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems", "author": ["frack113"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "b2317cfa-4a47-4ead-b3ff-297438c0bc2d", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "HackTool - SharpView Execution", "query": "((winlog.event_data.OriginalFileName:\"SharpView.exe\") OR (process.executable.text:\"*\\\\SharpView.exe\") OR (process.command_line.text:(\"*Add\\-RemoteConnection*\" OR \"*Convert\\-ADName*\" OR \"*ConvertFrom\\-SID*\" OR \"*ConvertFrom\\-UACValue*\" OR \"*Convert\\-SidToName*\" OR \"*Export\\-PowerViewCSV*\" OR \"*Find\\-DomainObjectPropertyOutlier*\" OR \"*Find\\-DomainProcess*\" OR \"*Find\\-DomainShare*\" OR \"*Find\\-DomainUserEvent*\" OR \"*Find\\-DomainUserLocation*\" OR \"*Find\\-ForeignGroup*\" OR \"*Find\\-ForeignUser*\" OR \"*Find\\-GPOComputerAdmin*\" OR \"*Find\\-GPOLocation*\" OR \"*Find\\-Interesting*\" OR \"*Find\\-LocalAdminAccess*\" OR \"*Find\\-ManagedSecurityGroups*\" OR \"*Get\\-CachedRDPConnection*\" OR \"*Get\\-DFSshare*\" OR \"*Get\\-DomainComputer*\" OR \"*Get\\-DomainController*\" OR \"*Get\\-DomainDFSShare*\" OR \"*Get\\-DomainDNSRecord*\" OR \"*Get\\-DomainFileServer*\" OR \"*Get\\-DomainForeign*\" OR \"*Get\\-DomainGPO*\" OR \"*Get\\-DomainGroup*\" OR \"*Get\\-DomainGUIDMap*\" OR \"*Get\\-DomainManagedSecurityGroup*\" OR \"*Get\\-DomainObject*\" OR \"*Get\\-DomainOU*\" OR \"*Get\\-DomainPolicy*\" OR \"*Get\\-DomainSID*\" OR \"*Get\\-DomainSite*\" OR \"*Get\\-DomainSPNTicket*\" OR \"*Get\\-DomainSubnet*\" OR \"*Get\\-DomainTrust*\" OR \"*Get\\-DomainUserEvent*\" OR \"*Get\\-ForestDomain*\" OR \"*Get\\-ForestGlobalCatalog*\" OR \"*Get\\-ForestTrust*\" OR \"*Get\\-GptTmpl*\" OR \"*Get\\-GroupsXML*\" OR \"*Get\\-LastLoggedOn*\" OR \"*Get\\-LoggedOnLocal*\" OR \"*Get\\-NetComputer*\" OR \"*Get\\-NetDomain*\" OR \"*Get\\-NetFileServer*\" OR \"*Get\\-NetForest*\" OR \"*Get\\-NetGPO*\" OR \"*Get\\-NetGroupMember*\" OR \"*Get\\-NetLocalGroup*\" OR \"*Get\\-NetLoggedon*\" OR \"*Get\\-NetOU*\" OR \"*Get\\-NetProcess*\" OR \"*Get\\-NetRDPSession*\" OR \"*Get\\-NetSession*\" OR \"*Get\\-NetShare*\" OR \"*Get\\-NetSite*\" OR \"*Get\\-NetSubnet*\" OR \"*Get\\-NetUser*\" OR \"*Get\\-PathAcl*\" OR \"*Get\\-PrincipalContext*\" OR \"*Get\\-RegistryMountedDrive*\" OR \"*Get\\-RegLoggedOn*\" OR \"*Get\\-WMIRegCachedRDPConnection*\" OR \"*Get\\-WMIRegLastLoggedOn*\" OR \"*Get\\-WMIRegMountedDrive*\" OR \"*Get\\-WMIRegProxy*\" OR \"*Invoke\\-ACLScanner*\" OR \"*Invoke\\-CheckLocalAdminAccess*\" OR \"*Invoke\\-Kerberoast*\" OR \"*Invoke\\-MapDomainTrust*\" OR \"*Invoke\\-RevertToSelf*\" OR \"*Invoke\\-Sharefinder*\" OR \"*Invoke\\-UserImpersonation*\" OR \"*Remove\\-DomainObjectAcl*\" OR \"*Remove\\-RemoteConnection*\" OR \"*Request\\-SPNTicket*\" OR \"*Set\\-DomainObject*\" OR \"*Test\\-AdminAccess*\")))", "meta": {"from": "1m"}, "severity": "high", "tags": ["T1033", "T1049", "T1069", "T1135", "T1482"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0007", "reference": "https://attack.mitre.org/tactics/TA0007", "name": "Discovery"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1033", "name": "System Owner/User Discovery", "reference": "https://attack.mitre.org/techniques/T1033"}, {"id": "T1049", "name": "System Network Connections Discovery", "reference": "https://attack.mitre.org/techniques/T1049"}, {"id": "T1069", "name": "Permission Groups Discovery", "reference": "https://attack.mitre.org/techniques/T1069"}, {"id": "T1135", "name": "Network Share Discovery", "reference": "https://attack.mitre.org/techniques/T1135"}, {"id": "T1482", "name": "Domain Trust Discovery", "reference": "https://attack.mitre.org/techniques/T1482"}]}], "version": 1, "references": ["https://github.com/tevora-threat/SharpView/", "https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1", "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md#atomic-test-4---system-discovery-using-sharpview"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
