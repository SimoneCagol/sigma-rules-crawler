{"description": "Detects the execution node.exe which is shipped with multiple software such as VMware, Adobe...etc. In order to execute arbitrary code. For example to establish reverse shell as seen in Log4j attacks...etc", "author": ["Nasreddine Bencherchali (Nextron Systems)"], "enabled": false, "false_positives": ["Unlikely"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "6640f31c-01ad-49b5-beb5-83498a5cd8bd", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Potential Arbitrary Code Execution Via Node.EXE", "query": "(process.executable.text:\"*\\\\node.exe\" AND process.command_line.text:(\"*\\ \\-e\\ *\" OR \"*\\ \\-\\-eval\\ *\") AND process.command_line.text:\"*.exec\\(*\" AND process.command_line.text:\"*net.socket*\" AND process.command_line.text:\"*.connect*\" AND process.command_line.text:\"*child_process*\")", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "T1127"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1127", "name": "Trusted Developer Utilities Proxy Execution", "reference": "https://attack.mitre.org/techniques/T1127"}]}], "version": 1, "references": ["http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html", "https://www.sprocketsecurity.com/resources/crossing-the-log4j-horizon-a-vulnerability-with-no-return", "https://www.rapid7.com/blog/post/2022/01/18/active-exploitation-of-vmware-horizon-servers/", "https://nodejs.org/api/cli.html"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
