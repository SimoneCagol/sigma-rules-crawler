{"description":"Detects suspicious powershell process which includes bxor command, alternative obfuscation method to b64 encoded commands. Author: Sami Ruohonen, Harish Segar (improvement), Tim Shelton. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["unknown"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"bb780e0c-16cf-4383-8383-1e5471db6cf9","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":35,"name":"Suspicious XOR Encoded PowerShell Command Line","query":"(((winlog.event_data.Description:\"Windows\\ PowerShell\" OR Product:\"PowerShell\\ Core\\ 6\") AND process.command_line:(*bxor* OR *\\-join\\ * OR *\\-join'* OR *\\-join\\\"* OR *\\-join`* OR *char*)) AND (NOT (process.parent.executable:\"C\\:\\\\Program\\ Files\\\\Amazon\\\\SSM\\\\ssm\\-document\\-worker.exe\")))","meta":{"from":"1m"},"severity":"medium","tags":["Defense Evasion","T1027","T1059","T1140"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0005","reference":"https://attack.mitre.org/tactics/TA0005","name":"Defense Evasion"},"framework":"MITRE ATT&CKÂ®","technique":[{"id":"T1027","name":"Obfuscated Files or Information","reference":"https://attack.mitre.org/techniques/T1027"},{"id":"T1140","name":"Deobfuscate/Decode Files or Information","reference":"https://attack.mitre.org/techniques/T1140"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
