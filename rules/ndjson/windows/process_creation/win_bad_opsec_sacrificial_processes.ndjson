{"description":"Detects attackers using tooling with bad opsec defaults e.g. spawning a sacrificial process to inject a capability into the process without taking into account how the process is normally run, one trivial example of this is using rundll32.exe without arguments as a sacrificial process (default in CS, now highlighted by c2lint), running WerFault without arguments (Kraken - credit am0nsec), and other examples. Author: Oleg Kolesnikov @securonix invrep_de, oscd.community, Florian Roth, Christian Burkard. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Unlikely"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"a7c3d773-caef-227e-a7e7-c2f13c622329","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":65,"name":"Bad Opsec Defaults Sacrificial Processes With Improper Arguments","query":"((process.executable:*\\\\WerFault.exe AND process.command_line:*\\\\WerFault.exe) OR (process.executable:*\\\\rundll32.exe AND process.command_line:*\\\\rundll32.exe) OR (process.executable:*\\\\regsvcs.exe AND process.command_line:*\\\\regsvcs.exe) OR (process.executable:*\\\\regasm.exe AND process.command_line:*\\\\regasm.exe) OR (process.executable:*\\\\regsvr32.exe AND process.command_line:*\\\\regsvr32.exe))","meta":{"from":"1m"},"severity":"high","tags":["Defense Evasion","T1218"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0005","reference":"https://attack.mitre.org/tactics/TA0005","name":"Defense Evasion"},"framework":"MITRE ATT&CKÂ®","technique":[{"id":"T1218","name":"Signed Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
