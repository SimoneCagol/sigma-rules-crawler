{"description": "Detects when a user installs certificates by using CertOC.exe to load the target DLL file.", "author": ["Nasreddine Bencherchali (Nextron Systems)"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "84232095-ecca-4015-b0d7-7726507ee793", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Suspicious DLL Loaded via CertOC.EXE", "query": "(((process.executable.text:\"*\\\\certoc.exe\") OR (winlog.event_data.OriginalFileName:\"CertOC.exe\")) AND process.command_line.text:(\"*\\ \\-LoadDLL\\ *\" OR \"*\\ \\/LoadDLL\\ *\") AND process.command_line.text:(\"*\\\\Appdata\\\\Local\\\\Temp\\\\*\" OR \"*\\\\Desktop\\\\*\" OR \"*\\\\Downloads\\\\*\" OR \"*\\\\Users\\\\Public\\\\*\" OR \"*C\\:\\\\Windows\\\\Tasks\\\\*\" OR \"*C\\:\\\\Windows\\\\Temp\\\\*\"))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "T1218"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1218", "name": "System Binary Proxy Execution", "reference": "https://attack.mitre.org/techniques/T1218"}]}], "version": 1, "references": ["https://twitter.com/sblmsrsn/status/1445758411803480072?s=20", "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-fe98e74189873d6df72a15df2eaa0315c59ba9cdaca93ecd68afc4ea09194ef2", "https://lolbas-project.github.io/lolbas/Binaries/Certoc/"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
