{"description": "Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems", "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "3bbeb74c-35ca-5505-5863-f4ea2abb9057", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Suspicious Execution of SharpView Aka PowerView", "query": "(winlog.event_data.OriginalFileName:\"SharpView.exe\" OR process.executable.text:*\\\\SharpView.exe OR process.command_line.text:(*Get\\-DomainGPOUserLocalGroupMapping* OR *Find\\-GPOLocation* OR *Get\\-DomainGPOComputerLocalGroupMapping* OR *Find\\-GPOComputerAdmin* OR *Get\\-DomainObjectAcl* OR *Add\\-DomainObjectAcl* OR *Add\\-ObjectAcl* OR *Remove\\-DomainObjectAcl* OR *Get\\-RegLoggedOn* OR *Get\\-LoggedOnLocal* OR *Get\\-NetRDPSession* OR *Test\\-AdminAccess* OR *Invoke\\-CheckLocalAdminAccess* OR *Get\\-WMIProcess* OR *Get\\-NetProcess* OR *Get\\-WMIRegProxy* OR *Get\\-WMIRegLastLoggedOn* OR *Get\\-LastLoggedOn* OR *Get\\-WMIRegCachedRDPConnection* OR *Get\\-CachedRDPConnection* OR *Get\\-WMIRegMountedDrive* OR *Get\\-RegistryMountedDrive* OR *Find\\-InterestingDomainAcl* OR *Invoke\\-ACLScanner* OR *Get\\-NetShare* OR *Get\\-NetLoggedon* OR *Get\\-NetLocalGroup* OR *Get\\-NetLocalGroupMember* OR *Get\\-NetSession* OR *Get\\-PathAcl* OR *ConvertFrom\\-UACValue* OR *Get\\-PrincipalContext* OR *New\\-DomainGroup* OR *New\\-DomainUser* OR *Add\\-DomainGroupMember* OR *Set\\-DomainUserPassword* OR *Invoke\\-Kerberoast* OR *Export\\-PowerViewCSV* OR *Find\\-LocalAdminAccess* OR *Find\\-DomainLocalGroupMember* OR *Find\\-DomainShare* OR *Find\\-DomainUserEvent* OR *Find\\-DomainProcess* OR *Find\\-DomainUserLocation* OR *Find\\-InterestingFile* OR *Find\\-InterestingDomainShareFile* OR *Find\\-DomainObjectPropertyOutlier* OR *Get\\-NetDomain* OR *Get\\-DomainComputer* OR *Get\\-NetComputer* OR *Get\\-DomainController* OR *Get\\-NetDomainController* OR *Get\\-DomainFileServer* OR *Get\\-NetFileServer* OR *Convert\\-ADName* OR *Get\\-DomainObject* OR *Get\\-ADObject* OR *Get\\-DomainUser* OR *Get\\-NetUser* OR *Get\\-DomainGroup* OR *Get\\-DomainDFSShare* OR *Get\\-DFSshare* OR *Get\\-DomainDNSRecord* OR *Get\\-DomainForeignGroupMember* OR *Find\\-ForeignGroup* OR *Get\\-DomainForeignUser* OR *Find\\-ForeignUser* OR *ConvertFrom\\-SID* OR *Convert\\-SidToName* OR *Get\\-DomainGroupMember* OR *Get\\-NetGroupMember* OR *Get\\-DomainManagedSecurityGroup* OR *Find\\-ManagedSecurityGroups* OR *Get\\-DomainOU* OR *Get\\-NetOU* OR *Get\\-DomainSID* OR *Get\\-NetForest* OR *Get\\-ForestTrust* OR *Get\\-NetForestTrust* OR *Get\\-DomainTrust* OR *Get\\-NetDomainTrust* OR *Get\\-ForestDomain* OR *Get\\-NetForestDomain* OR *Get\\-DomainSite* OR *Get\\-NetSite* OR *Get\\-DomainSubnet* OR *Get\\-NetSubnet* OR *Get\\-DomainTrustMapping* OR *Invoke\\-MapDomainTrust* OR *Get\\-ForestGlobalCatalog* OR *Get\\-NetForestCatalog* OR *Get\\-DomainUserEvent* OR *Get\\-DomainGUIDMap* OR *Resolve\\-IPAddress* OR *ConvertTo\\-SID* OR *Invoke\\-UserImpersonation* OR *Get\\-DomainSPNTicket* OR *Request\\-SPNTicket* OR *Get\\-NetComputerSiteName* OR *Get\\-DomainGPO* OR *Get\\-NetGPO* OR *Set\\-DomainObject* OR *Add\\-RemoteConnection* OR *Remove\\-RemoteConnection* OR *Get\\-GptTmpl* OR *Get\\-GroupsXML* OR *Get\\-DomainPolicyData* OR *Get\\-DomainPolicy* OR *Get\\-DomainGPOLocalGroup* OR *Get\\-NetGPOGroup* OR *Invoke\\-Sharefinder*))", "meta": {"from": "1m"}, "severity": "high", "tags": ["T1033", "T1049", "T1069", "T1135", "T1482"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0007", "reference": "https://attack.mitre.org/tactics/TA0007", "name": "Discovery"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1033", "name": "System Owner/User Discovery", "reference": "https://attack.mitre.org/techniques/T1033"}, {"id": "T1049", "name": "System Network Connections Discovery", "reference": "https://attack.mitre.org/techniques/T1049"}, {"id": "T1069", "name": "Permission Groups Discovery", "reference": "https://attack.mitre.org/techniques/T1069"}, {"id": "T1135", "name": "Network Share Discovery", "reference": "https://attack.mitre.org/techniques/T1135"}, {"id": "T1482", "name": "Domain Trust Discovery", "reference": "https://attack.mitre.org/techniques/T1482"}]}], "version": 1, "references": ["https://github.com/tevora-threat/SharpView/", "https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1", "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md#atomic-test-4---system-discovery-using-sharpview"], "timestamp_override": "event.ingested", "author": ["frack113"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
