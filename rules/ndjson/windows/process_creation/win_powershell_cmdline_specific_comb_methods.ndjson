{"description":"Detects specific combinations of encoding methods in the PowerShell command lines Author: Teymur Kheirkhabarov (idea), Vasiliy Burov (rule), oscd.community. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["Unlikely"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"cdf05894-89e7-4ead-b2b0-0a5f97a90f2f","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":35,"name":"Encoded PowerShell Command Line","query":"(process.executable:*\\\\powershell.exe AND ((((process.command_line:(*ToInt* OR *ToDecimal* OR *ToByte* OR *ToUint* OR *ToSingle* OR *ToSByte*) AND process.command_line:(*ToChar* OR *ToString* OR *String*)) OR (process.command_line:*char* AND process.command_line:*join*)) OR (process.command_line:*split* AND process.command_line:*join*)) OR (process.command_line:*ForEach* AND process.command_line:*Xor*) OR process.command_line:*cOnvErTTO\\-SECUreStRIng*))","meta":{"from":"1m"},"severity":"medium","tags":["Defense Evasion","T1027","T1059"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0002","reference":"https://attack.mitre.org/tactics/TA0002","name":"Execution"},"framework":"MITRE ATT&CK®","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059"}]},{"tactic":{"id":"TA0005","reference":"https://attack.mitre.org/tactics/TA0005","name":"Defense Evasion"},"framework":"MITRE ATT&CK®","technique":[{"id":"T1027","name":"Obfuscated Files or Information","reference":"https://attack.mitre.org/techniques/T1027"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
