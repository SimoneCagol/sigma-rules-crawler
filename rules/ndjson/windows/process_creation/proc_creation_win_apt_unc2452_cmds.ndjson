{"description": "Detects a specific process creation patterns as seen used by UNC2452 and provided by Microsoft as Microsoft Defender ATP queries", "author": ["Florian Roth"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "6504350a-67c7-8e72-aea9-5be509a2b2a0", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "UNC2452 Process Creation Patterns", "query": "((((process.command_line.text:*7z.exe\\ a\\ \\-v500m\\ \\-mx9\\ \\-r0\\ \\-p*) OR ((process.parent.command_line.text:*wscript.exe* AND process.parent.command_line.text:*.vbs* AND process.command_line.text:*rundll32.exe* AND process.command_line.text:*C\\:\\\\Windows* AND process.command_line.text:*.dll,Tk_*)) OR ((process.parent.executable.text:*\\\\rundll32.exe AND process.parent.command_line.text:*C\\:\\\\Windows* AND process.command_line.text:*cmd.exe\\ \\/C\\ *)) OR ((process.command_line.text:*rundll32\\ c\\:\\\\windows\\\\* AND process.command_line.text:*.dll\\ *)))) OR (((process.parent.executable.text:*\\\\rundll32.exe AND process.executable.text:*\\\\dllhost.exe) AND (NOT (process.command_line.text:(\"\" OR \"\"))))))", "meta": {"from": "1m"}, "severity": "high", "tags": ["T1059"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0002", "reference": "https://attack.mitre.org/tactics/TA0002", "name": "Execution"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1059", "name": "Command and Scripting Interpreter", "reference": "https://attack.mitre.org/techniques/T1059"}]}], "version": 1, "references": ["https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
