{"description": "Detects processes spawned from web servers (php, tomcat, iis...etc) that perform reconnaissance looking for the existence of popular scripting tools (perl, python, wget) on the system via the help commands", "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "d6b9f78d-bb8e-95e6-0541-8afa09e24f03", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Webshell Recon Detection Via CommandLine & Processes", "query": "((process.parent.executable.text:(*\\\\w3wp.exe OR *\\\\php\\-cgi.exe OR *\\\\nginx.exe OR *\\\\httpd.exe OR *\\\\caddy.exe OR *\\\\ws_tomcatservice.exe) OR (process.parent.executable.text:(*\\\\java.exe OR *\\\\javaw.exe) AND process.parent.executable.text:(*\\-tomcat\\-* OR *\\\\tomcat*)) OR (process.parent.executable.text:(*\\\\java.exe OR *\\\\javaw.exe) AND process.command_line.text:(*catalina.jar* OR *CATALINA_HOME*))) AND process.command_line.text:(*perl\\ \\-\\-help* OR *python\\ \\-\\-help* OR *python\\ \\-h* OR *python3\\ \\-\\-help* OR *python3\\ \\-h* OR *wget\\ \\-\\-help* OR *perl\\ \\-h*))", "meta": {"from": "1m"}, "severity": "high", "tags": ["T1505"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0003", "reference": "https://attack.mitre.org/tactics/TA0003", "name": "Persistence"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1505", "name": "Server Software Component", "reference": "https://attack.mitre.org/techniques/T1505"}]}], "version": 1, "references": ["https://ragged-lab.blogspot.com/2020/07/webshells-automating-reconnaissance.html"], "timestamp_override": "event.ingested", "author": ["Cian Heasley", "Florian Roth"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
