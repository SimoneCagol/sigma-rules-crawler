{"description":"detects the usage of path traversal in cmd.exe indicating possible command/argument confusion/hijacking Author: xknow @xknow_infosec, Tim Shelton. License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md","enabled":false,"false_positives":["(not much) some benign Java tools may product false-positive commandlines for loading libraries"],"filters":[],"from":"now-360s","immutable":false,"index":["winlogbeat-*"],"interval":"5m","rule_id":"9f9c4bb0-7db9-e81d-b744-9a871a944a6b","language":"lucene","output_index":".siem-signals-default","max_signals":100,"risk_score":65,"name":"Cmd.exe CommandLine Path Traversal","query":"((process.parent.command_line:*cmd* AND process.parent.command_line:*\\/c* AND process.command_line:*\\/..\\/..\\/*) AND (NOT ((process.command_line:*\\\\Tasktop\\\\keycloak\\\\bin\\\\\\/..\\/..\\/jre\\\\bin\\\\java*))))","meta":{"from":"1m"},"severity":"high","tags":["T1059"],"to":"now","type":"query","threat":[{"tactic":{"id":"TA0002","reference":"https://attack.mitre.org/tactics/TA0002","name":"Execution"},"framework":"MITRE ATT&CKÂ®","technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059"}]}],"version":1,"references":["https://tdm.socprime.com/tdm/info/0"]}
