{"description": "Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)", "author": ["Florian Roth"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "ddb9eabd-2e46-a492-327c-6e621996e4cb", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Terminal Service Process Spawn", "query": "((process.parent.command_line.text:*\\\\svchost.exe* AND process.parent.command_line.text:*termsvcs*) AND (NOT ((process.executable.text:(*\\\\rdpclip.exe OR *\\:\\\\Windows\\\\System32\\\\csrss.exe OR *\\:\\\\Windows\\\\System32\\\\wininit.exe OR *\\:\\\\Windows\\\\System32\\\\winlogon.exe)) OR (NOT _exists_:process.executable.text))))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Initial Access", "Lateral Movement", "T1190", "T1210"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0001", "reference": "https://attack.mitre.org/tactics/TA0001", "name": "Initial Access"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1190", "name": "Exploit Public-Facing Application", "reference": "https://attack.mitre.org/techniques/T1190"}]}, {"tactic": {"id": "TA0008", "reference": "https://attack.mitre.org/tactics/TA0008", "name": "Lateral Movement"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1210", "name": "Exploitation of Remote Services", "reference": "https://attack.mitre.org/techniques/T1210"}]}], "version": 1, "references": ["https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/rdp-stands-for-really-do-patch-understanding-the-wormable-rdp-vulnerability-cve-2019-0708/"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
