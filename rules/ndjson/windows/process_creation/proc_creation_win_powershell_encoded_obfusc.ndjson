{"description": "Detects suspicious UTF16 and base64 encoded and often obfuscated PowerShell code often used in command lines", "author": ["Florian Roth (Nextron Systems)"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "8d01b53f-456f-48ee-90f6-bc28e67d4e35", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Suspicious Obfuscated PowerShell Code", "query": "process.command_line.text:(\"*IAAtAGIAeABvAHIAIAAwAHgA*\" OR \"*AALQBiAHgAbwByACAAMAB4A*\" OR \"*gAC0AYgB4AG8AcgAgADAAeA*\" OR \"*AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg*\" OR \"*AuAEkAbgB2AG8AawBlACgAKQAgAHwAI*\" OR \"*ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC*\" OR \"*AHsAMQB9AHsAMAB9ACIAIAAtAGYAI*\" OR \"*B7ADEAfQB7ADAAfQAiACAALQBmAC*\" OR \"*AewAxAH0AewAwAH0AIgAgAC0AZgAg*\" OR \"*AHsAMAB9AHsAMwB9ACIAIAAtAGYAI*\" OR \"*B7ADAAfQB7ADMAfQAiACAALQBmAC*\" OR \"*AewAwAH0AewAzAH0AIgAgAC0AZgAg*\" OR \"*AHsAMgB9AHsAMAB9ACIAIAAtAGYAI*\" OR \"*B7ADIAfQB7ADAAfQAiACAALQBmAC*\" OR \"*AewAyAH0AewAwAH0AIgAgAC0AZgAg*\" OR \"*AHsAMQB9AHsAMAB9ACcAIAAtAGYAI*\" OR \"*B7ADEAfQB7ADAAfQAnACAALQBmAC*\" OR \"*AewAxAH0AewAwAH0AJwAgAC0AZgAg*\" OR \"*AHsAMAB9AHsAMwB9ACcAIAAtAGYAI*\" OR \"*B7ADAAfQB7ADMAfQAnACAALQBmAC*\" OR \"*AewAwAH0AewAzAH0AJwAgAC0AZgAg*\" OR \"*AHsAMgB9AHsAMAB9ACcAIAAtAGYAI*\" OR \"*B7ADIAfQB7ADAAfQAnACAALQBmAC*\" OR \"*AewAyAH0AewAwAH0AJwAgAC0AZgAg*\")", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion"], "to": "now", "type": "query", "threat": [], "version": 1, "references": ["https://app.any.run/tasks/fcadca91-3580-4ede-aff4-4d2bf809bf99/"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
