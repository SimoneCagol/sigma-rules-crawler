{"description": "Detects the usage of the \"Squirrel.exe\" binary as a LOLBIN. This binary is part of multiple software installations (Slack, Teams, Discord, etc.)", "author": ["Nasreddine Bencherchali (Nextron Systems)", "Karneades / Markus Neis", "Jonhnathan Ribeiro", "oscd.community"], "enabled": false, "false_positives": ["Expected FP with some electron based applications such as (1Clipboard, Beaker Browser, Caret, Discord, GitHub Desktop,...Etc)"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "45239e6a-b035-4aaf-b339-8ad379fcb67e", "language": "lucene", "max_signals": 100, "risk_score": 35, "name": "Use of Squirrel.exe", "query": "((process.executable.text:(\"*\\\\squirrel.exe\" OR \"*\\\\update.exe\") AND (((process.command_line.text:(\"*\\ \\-\\-download\\ *\" OR \"*\\ \\-\\-update\\ *\" OR \"*\\ \\-\\-updateRollback\\=*\") AND process.command_line.text:\"*http*\")) OR (process.command_line.text:(\"*\\-\\-processStart*\" OR \"*\\-\\-processStartAndWait*\" OR \"*\\-\\-createShortcut*\")))) AND (NOT ((process.command_line.text:\"*C\\:\\\\Users\\\\*\" AND process.command_line.text:\"*\\\\AppData\\\\Local\\\\Discord\\\\Update.exe*\" AND process.command_line.text:\"*\\ \\-\\-processStart*\" AND process.command_line.text:\"*Discord.exe*\") OR ((process.command_line.text:\"*C\\:\\\\Users\\\\*\" AND process.command_line.text:\"*\\\\AppData\\\\Local\\\\GitHubDesktop\\\\Update.exe*\" AND process.command_line.text:\"*GitHubDesktop.exe*\" AND process.command_line.text:(\"*\\-\\-createShortcut*\" OR \"*\\-\\-processStartAndWait*\"))) OR ((process.command_line.text:\"*C\\:\\\\Users\\\\*\" AND process.command_line.text:\"*\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\Update.exe*\" AND process.command_line.text:\"*Teams.exe*\" AND process.command_line.text:(\"*\\-\\-processStart*\" OR \"*\\-\\-createShortcut*\"))) OR ((process.command_line.text:\"*C\\:\\\\Users\\\\*\" AND process.command_line.text:\"*\\\\AppData\\\\Local\\\\yammerdesktop\\\\Update.exe*\" AND process.command_line.text:\"*Yammer.exe*\" AND process.command_line.text:(\"*\\-\\-processStart*\" OR \"*\\-\\-createShortcut*\"))))))", "meta": {"from": "1m"}, "severity": "medium", "tags": ["Defense Evasion", "T1218"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1218", "name": "System Binary Proxy Execution", "reference": "https://attack.mitre.org/techniques/T1218"}]}], "version": 1, "references": ["https://lolbas-project.github.io/lolbas/OtherMSBinaries/Squirrel/", "http://www.hexacorn.com/blog/2019/03/30/sqirrel-packages-manager-as-a-lolbin-a-k-a-many-electron-apps-are-lolbins-by-default/", "http://www.hexacorn.com/blog/2018/08/16/squirrel-as-a-lolbin/"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
