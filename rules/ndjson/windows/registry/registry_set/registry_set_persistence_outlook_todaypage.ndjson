{"description": "Detects potential persistence activity via outlook today pages. An attacker can set a custom page to execute arbitrary code and link to it via the registry key \"UserDefinedUrl\".", "author": ["Tobias Michalski (Nextron Systems)"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "487bb375-12ef-41f6-baae-c6a1572b4dd1", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Potential Persistence Via Outlook Today Pages", "query": "(((winlog.event_data.EventType:\"SetValue\" AND winlog.event_data.TargetObject:*Software\\\\Microsoft\\\\Office\\\\* AND winlog.event_data.TargetObject:*\\\\Outlook\\\\Today\\\\*) AND (((winlog.event_data.TargetObject:*Stamp AND winlog.event_data.Details:\"DWORD (0x00000001)\")) OR (winlog.event_data.TargetObject:*UserDefinedUrl))) AND (NOT (process.executable.text:(\"C\\:\\\\Program\\ Files\\\\Common\\ Files\\\\Microsoft\\ Shared\\\\ClickToRun\\\\*\" OR \"C\\:\\\\Program\\ Files\\\\Common\\ Files\\\\Microsoft\\ Shared\\\\ClickToRun\\\\Updates\\\\*\") AND process.executable.text:\"*\\\\OfficeClickToRun.exe\")))", "meta": {"from": "1m"}, "severity": "high", "tags": ["T1112"], "to": "now", "type": "query", "threat": [], "version": 1, "references": ["https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=74"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
