{"description": "Detects registry keys created in OceanLotus (also known as APT32) attacks", "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "3f72f736-8a86-7394-1db3-c63216de2d75", "language": "lucene", "max_signals": 100, "risk_score": 95, "name": "OceanLotus Registry Activity", "query": "((winlog.event_data.TargetObject:\"HKCU\\\\SOFTWARE\\\\Classes\\\\CLSID\\\\\\{E08A0F4B\\-1F65\\-4D4D\\-9A09\\-BD4625B9C5A1\\}\\\\Model\" OR (winlog.event_data.TargetObject:(HKCU\\\\SOFTWARE\\\\App\\\\* OR HKLM\\\\SOFTWARE\\\\App\\\\*) AND winlog.event_data.TargetObject:(*AppXbf13d4ea2945444d8b13e2121cb6b663\\\\* OR *AppX70162486c7554f7f80f481985d67586d\\\\* OR *AppX37cc7fdccd644b4f85f4b22d5a3f105a\\\\*) AND winlog.event_data.TargetObject:(*Application OR *DefaultIcon))) OR (winlog.event_data.TargetObject:HKCU\\\\* AND winlog.event_data.TargetObject:(*Classes\\\\AppXc52346ec40fb4061ad96be0e6cb7d16a\\\\* OR *Classes\\\\AppX3bbba44c6cae4d9695755183472171e2\\\\* OR *Classes\\\\CLSID\\\\\\{E3517E26\\-8E93\\-458D\\-A6DF\\-8030BC80528B\\}\\\\* OR *Classes\\\\CLSID\\\\\\{E08A0F4B\\-1F65\\-4D4D\\-9A09\\-BD4625B9C5A1\\}\\\\Model*)))", "meta": {"from": "1m"}, "severity": "critical", "tags": ["Defense Evasion", "T1112"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1112", "name": "Modify Registry", "reference": "https://attack.mitre.org/techniques/T1112"}]}], "version": 1, "references": ["https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/", "https://github.com/eset/malware-ioc/tree/master/oceanlotus"], "timestamp_override": "event.ingested", "author": ["megan201296", "Jonhnathan Ribeiro"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
