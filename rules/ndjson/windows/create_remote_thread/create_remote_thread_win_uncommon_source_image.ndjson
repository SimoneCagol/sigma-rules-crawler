{"description": "Detects uncommon processes creating remote threads", "author": ["Perez Diego (@darkquassar)", "oscd.community"], "enabled": false, "false_positives": ["Unknown"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "66d31e5f-52d6-40a4-9615-002d3789a119", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Remote Thread Creation By Uncommon Source Image", "query": "((process.executable.text:(\"*\\\\bash.exe\" OR \"*\\\\cscript.exe\" OR \"*\\\\cvtres.exe\" OR \"*\\\\defrag.exe\" OR \"*\\\\dnx.exe\" OR \"*\\\\esentutl.exe\" OR \"*\\\\excel.exe\" OR \"*\\\\expand.exe\" OR \"*\\\\explorer.exe\" OR \"*\\\\find.exe\" OR \"*\\\\findstr.exe\" OR \"*\\\\forfiles.exe\" OR \"*\\\\gpupdate.exe\" OR \"*\\\\hh.exe\" OR \"*\\\\iexplore.exe\" OR \"*\\\\installutil.exe\" OR \"*\\\\lync.exe\" OR \"*\\\\makecab.exe\" OR \"*\\\\mDNSResponder.exe\" OR \"*\\\\monitoringhost.exe\" OR \"*\\\\msbuild.exe\" OR \"*\\\\mshta.exe\" OR \"*\\\\msiexec.exe\" OR \"*\\\\mspaint.exe\" OR \"*\\\\outlook.exe\" OR \"*\\\\ping.exe\" OR \"*\\\\powerpnt.exe\" OR \"*\\\\provtool.exe\" OR \"*\\\\python.exe\" OR \"*\\\\regsvr32.exe\" OR \"*\\\\robocopy.exe\" OR \"*\\\\runonce.exe\" OR \"*\\\\sapcimc.exe\" OR \"*\\\\schtasks.exe\" OR \"*\\\\smartscreen.exe\" OR \"*\\\\spoolsv.exe\" OR \"*\\\\tstheme.exe\" OR \"*\\\\userinit.exe\" OR \"*\\\\vssadmin.exe\" OR \"*\\\\vssvc.exe\" OR \"*\\\\w3wp.exe\" OR \"*\\\\winlogon.exe\" OR \"*\\\\winscp.exe\" OR \"*\\\\winword.exe\" OR \"*\\\\wmic.exe\" OR \"*\\\\wscript.exe\") AND (NOT (((process.executable.text:\"C:\\Windows\\System32\\winlogon.exe\" AND winlog.event_data.TargetImage:(\"C:\\Windows\\System32\\services.exe\" OR \"C:\\Windows\\System32\\wininit.exe\" OR \"C:\\Windows\\System32\\csrss.exe\"))) OR ((process.executable.text:\"C:\\Windows\\System32\\winlogon.exe\" AND TargetParentImage:\"System\" AND TargetParentProcessId:\"4\")) OR ((process.executable.text:\"C:\\Windows\\System32\\provtool.exe\" AND TargetParentProcessId:\"0\")) OR ((process.executable.text:\"C:\\Windows\\System32\\VSSVC.exe\" AND winlog.event_data.TargetImage:\"System\")) OR ((process.executable.text:(\"C:\\Windows\\System32\\schtasks.exe\" OR \"C:\\Windows\\SysWOW64\\schtasks.exe\") AND winlog.event_data.TargetImage:\"C:\\Windows\\System32\\conhost.exe\"))))) AND (NOT (process.executable.text:\"C:\\Windows\\explorer.exe\" AND winlog.event_data.TargetImage:\"C:\\Program Files\\NVIDIA Corporation\\NVIDIA GeForce Experience\\NVIDIA GeForce Experience.exe\")))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "Privilege Escalation", "T1055"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0004", "reference": "https://attack.mitre.org/tactics/TA0004", "name": "Privilege Escalation"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1055", "name": "Process Injection", "reference": "https://attack.mitre.org/techniques/T1055"}]}, {"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1055", "name": "Process Injection", "reference": "https://attack.mitre.org/techniques/T1055"}]}], "version": 1, "references": ["Personal research, statistical analysis", "https://lolbas-project.github.io"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
