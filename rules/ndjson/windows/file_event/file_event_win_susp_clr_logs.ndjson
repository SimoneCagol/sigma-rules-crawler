{"description": "Detects suspicious .NET assembly executions. Could detect using Cobalt Strike's command execute-assembly.", "enabled": false, "false_positives": ["https://twitter.com/SBousseaden/status/1388064061087260675 - rundll32.exe with zzzzInvokeManagedCustomActionOutOfProc in command line and msiexec.exe as parent process"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "e4b63079-6198-405c-abd7-3fe8b0ce3263", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Suspcious CLR Logs Creation", "query": "(file.path:*\\\\AppData\\\\Local\\\\Microsoft\\\\CLR* AND file.path:*\\\\UsageLogs\\\\* AND file.path:(*mshta* OR *cscript* OR *wscript* OR *regsvr32* OR *wmic* OR *rundll32* OR *svchost*))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "T1059", "T1218"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0002", "reference": "https://attack.mitre.org/tactics/TA0002", "name": "Execution"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1059", "name": "Command and Scripting Interpreter", "reference": "https://attack.mitre.org/techniques/T1059"}]}, {"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK\u00ae", "technique": [{"id": "T1218", "name": "Signed Binary Proxy Execution", "reference": "https://attack.mitre.org/techniques/T1218"}]}], "version": 1, "references": ["https://blog.menasec.net/2019/07/interesting-difr-traces-of-net-clr.html", "https://bohops.com/2021/03/16/investigating-net-clr-usage-log-tampering-techniques-for-edr-evasion/", "https://github.com/olafhartong/sysmon-modular/blob/master/11_file_create/include_dotnet.xml"], "timestamp_override": "event.ingested", "author": ["omkar72", "oscd.community", "Wojciech Lesicki"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md"}
