{"description": "Detects creation of the Process Explorer drivers by processes other than Process Explorer (procexp) itself.\nHack tools or malware may use the Process Explorer driver to elevate privileges, drops it to disk for a few moments, runs a service using that driver and removes it afterwards.\n", "author": ["Florian Roth (Nextron Systems)"], "enabled": false, "false_positives": ["Some false positives may occur with legitimate renamed process explorer binaries"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "de46c52b-0bf8-4936-a327-aace94f94ac6", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Process Explorer Driver Creation By Non-Sysinternals Binary", "query": "((file.path.text:\"*\\\\PROCEXP*\" AND file.path.text:\"*.sys\") AND (NOT process.executable.text:(\"*\\\\procexp.exe\" OR \"*\\\\procexp64.exe\")))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Privilege Escalation", "T1068"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0004", "reference": "https://attack.mitre.org/tactics/TA0004", "name": "Privilege Escalation"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1068", "name": "Exploitation for Privilege Escalation", "reference": "https://attack.mitre.org/techniques/T1068"}]}], "version": 1, "references": ["https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer", "https://github.com/Yaxser/Backstab", "https://www.elastic.co/security-labs/stopping-vulnerable-driver-attacks", "https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
