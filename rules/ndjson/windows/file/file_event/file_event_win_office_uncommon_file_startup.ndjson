{"description": "Detects the creation of a file with an uncommon extension in an Office application startup folder", "author": ["frack113", "Nasreddine Bencherchali (Nextron Systems)"], "enabled": false, "false_positives": ["Other legitimate extensions used by either excel or word"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "a10a2c40-2c4d-49f8-b557-1a946bc55d9d", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "Uncommon File Created In Office Startup Folder", "query": "((((((file.path.text:\"*\\\\Microsoft\\\\Word\\\\STARTUP*\") OR ((file.path.text:\"*\\\\Office*\" AND file.path.text:\"*\\\\Program\\ Files*\" AND file.path.text:\"*\\\\STARTUP*\"))) AND (NOT file.path.text:(\"*.docb\" OR \"*.docm\" OR \"*.docx\" OR \"*.dotm\" OR \"*.pdf\" OR \"*.wll\" OR \"*.wwl\")))) OR ((((file.path.text:\"*\\\\Microsoft\\\\Excel\\\\XLSTART*\") OR ((file.path.text:\"*\\\\Office*\" AND file.path.text:\"*\\\\Program\\ Files*\" AND file.path.text:\"*\\\\XLSTART*\"))) AND (NOT file.path.text:(\"*.xls\" OR \"*.xlsm\" OR \"*.xlsx\" OR \"*.xlt\" OR \"*.xltm\" OR \"*.xll\" OR \"*.xlw\"))))) AND (NOT (((process.executable.text:\"C\\:\\\\Program\\ Files\\\\Common\\ Files\\\\Microsoft\\ Shared\\\\ClickToRun\\\\*\" AND process.executable.text:\"*\\\\OfficeClickToRun.exe\")) OR ((process.executable.text:(\"C\\:\\\\Program\\ Files\\\\Microsoft\\ Office\\\\*\" OR \"C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\Microsoft\\ Office\\\\*\") AND process.executable.text:(\"*\\\\winword.exe\" OR \"*\\\\excel.exe\"))))))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Resource Development", "T1587"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0042", "reference": "https://attack.mitre.org/tactics/TA0042", "name": "Resource Development"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1587", "name": "Develop Capabilities", "reference": "https://attack.mitre.org/techniques/T1587"}]}], "version": 1, "references": ["https://app.any.run/tasks/d6fe6624-6ef8-485d-aa75-3d1bdda2a08c/", "http://addbalance.com/word/startup.htm", "https://answers.microsoft.com/en-us/msoffice/forum/all/document-in-word-startup-folder-doesnt-open-when/44ab0932-2917-4150-8cdc-2f2cf39e86f3", "https://en.wikipedia.org/wiki/List_of_Microsoft_Office_filename_extensions"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
