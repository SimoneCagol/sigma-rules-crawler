{"description": "Detects the creation of new files with the \".evtx\" extension in non-common locations. Which could indicate tampering with default evtx locations in order to evade security controls", "author": ["D3F7A5105"], "enabled": false, "false_positives": ["Administrator or backup activity"], "filters": [], "from": "now-360s", "immutable": false, "index": ["winlogbeat-*"], "interval": "5m", "rule_id": "65236ec7-ace0-4f0c-82fd-737b04fd4dcb", "language": "lucene", "max_signals": 100, "risk_score": 65, "name": "EVTX Created In Uncommon Location", "query": "(file.path:/.*\\.[Ee][Vv][Tt][Xx]/ AND (NOT ((file.path:/[Cc]\\:\\\\\\\\[Ww][Ii][Nn][Dd][Oo][Ww][Ss]\\\\\\\\[Ss][Yy][Ss][Tt][Ee][Mm]32\\\\\\\\[Ww][Ii][Nn][Ee][Vv][Tt]\\\\\\\\[Ll][Oo][Gg][Ss]\\\\\\\\.*/) OR ((file.path:/[Cc]\\:\\\\\\\\[Pp][Rr][Oo][Gg][Rr][Aa][Mm][Dd][Aa][Tt][Aa]\\\\\\\\[Mm][Ii][Cc][Rr][Oo][Ss][Oo][Ff][Tt]\\\\\\\\[Ww][Ii][Nn][Dd][Oo][Ww][Ss]\\\\\\\\[Cc][Oo][Nn][Tt][Aa][Ii][Nn][Ee][Rr][Ss]\\\\\\\\[Bb][Aa][Ss][Ee][Ii][Mm][Aa][Gg][Ee][Ss]\\\\\\\\.*/ AND file.path:/.*\\\\\\\\[Ww][Ii][Nn][Dd][Oo][Ww][Ss]\\\\\\\\[Ss][Yy][Ss][Tt][Ee][Mm]32\\\\\\\\[Ww][Ii][Nn][Ee][Vv][Tt]\\\\\\\\[Ll][Oo][Gg][Ss]\\\\\\\\/)) OR (process.executable:(/[Cc]\\:\\\\\\\\[Ww][Ii][Nn][Dd][Oo][Ww][Ss]\\\\\\\\[Ee][Xx][Pp][Ll][Oo][Rr][Ee][Rr]\\.[Ee][Xx][Ee]/ OR /[Cc]\\:\\\\\\\\[Ww][Ii][Nn][Dd][Oo][Ww][Ss]\\\\\\\\[Ss][Yy][Ss][Tt][Ee][Mm]32\\\\\\\\[Dd][Ll][Ll][Hh][Oo][Ss][Tt]\\.[Ee][Xx][Ee]/)))))", "meta": {"from": "1m"}, "severity": "high", "tags": ["Defense Evasion", "T1562"], "to": "now", "type": "query", "threat": [{"tactic": {"id": "TA0005", "reference": "https://attack.mitre.org/tactics/TA0005", "name": "Defense Evasion"}, "framework": "MITRE ATT&CK", "technique": [{"id": "T1562", "name": "Impair Defenses", "reference": "https://attack.mitre.org/techniques/T1562"}]}], "version": 1, "references": ["https://learn.microsoft.com/en-us/windows/win32/eventlog/eventlog-key"], "license": "https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md", "timestamp_override": "event.ingested"}
